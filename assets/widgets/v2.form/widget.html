<style>
.action {
  font-size: medium;
  color: #008cba;
  font-weight: bold;
}

.sectionHeader {
  margin-top: 1em;
  border-bottom: 2px solid #999999;
  padding-left: 1em;
}

</style>
<div class="row" ng-controller="FormController" style="padding: 0.5rem; margin: 0;">

    


<!-- <pre>{{user | json}}</pre> -->
   
  <!-- <div class="row" style="font-size: small;">
      <div class="column small-12">
          <div class="column small-6">
            <h4>Form</h4>
            <pre> {{ widget | json }} </pre>
          </div>
          <div class="column small-6">
            <h4>Answer</h4>
            <pre> {{ answer | json }} </pre>
          </div>
      </div>  
  </div>  
  <hr/>
 
    <div ng-if="bool" class="fade">
    Show and hide me
  </div> -->
 <!--  <button ng-click="reload()">REload</button>
 <pre> {{widget.form.config.access | json}} </pre> -->
  <div  class="fan-btn top fade" 
        ng-if="!globalConfig.designMode && fanButton._state"

  >
    
        <div>
           <span   style="   color: white;
                              background: {{fanButton._state.color}};
                           "
                    ng-mouseenter="fanButton.showTooltip()"
                    ng-mouseleave="fanButton.hideTooltip()"
                    ng-click="saveAnswers()"
                   
                    
            >
                <i ng-class="fanButton._state.class"/>  
            </span>
        </div>



          <div  class="fantip fade"
                ng-if="fanButton._showFantip" 
                style=" background: #ffffff;
                        color: {{fanButton._state.color}};"
          >
            
            <table style="border:none; margin: 0;" 
                  ng-if="widget.form.config.access.type == 'invited' || widget.form.config.access.type == 'users'"
            >
              <tr>
                
                <td style="border:none;">
                  <div  class="left"
                        style=" 
                          background-image: url({{user.photo}});
                          background-size: 3em 3em;
                          
                          border-radius: 50%;
                          display: block;
                          overflow: hidden;
                          position: relative;
                          height: 3em;
                          width: 3em;
                          "
                        ng-if="user.photo"
                  >
                  </div>
                  <i    ng-if="!user.photo"
                        class="fa fa-user-circle"
                        style="     font-size: 2.75em;
                                      padding: 0 0 0 0.16em;
                                      color: #cedded;"
                  />
                </td>
                <td style="border:none;">
                  <label class="large">
                    {{user.name || user.email}}!
                  </label>  
                </td>
              </tr>  
            </table>  
              
            <div style="margin:0 1em;">
              {{fanButton._state.tooltip}}
            </div>
          </div>  
    
  </div>    
  
  <div ng-show="globalConfig.designMode">
    <h3 ng-if="isDisabled()" style="  color: #f08a24;" class="fi-alert"> 
      DJ-Form is disabled. You can use only single instance of DJ-Form per page.
    </h3>
    <div ng-if="!isDisabled() && processing" class="row">
      <div class="column small-2 small-centered" style="  text-align:center;
              color:#999;
              font-size:xx-large">
        <i class="fa fa-spinner fa-pulse" />
      </div>
    </div>
    <div ng-if="!isDisabled() && !processing" class="row" style="margin: 0.5em 0 0 0; height:auto;">
      <h3> 
      DJ-Form <span style="font-size: smaller;">#{{widget.form.id}}</span>
    </h3>
    <div class="row">
      <div class="column small-12">
        <button class="tiny button" ng-click="openImportDialog()">
          Import
        </button>  
      </div>  
    </div>  
    <div class="row" ng-if="pageLocation != widget.form.metadata.app_url.value">
      <div class="column small-12">
        <div style="  color: rgb(240, 138, 36);">
          <i class="fa fa-exclamation-triangle" style="margin:0 0.5em;"/>
          <span style="margin:0 0.5em;"> Page and Form mismatch.</span>
          <span class="button tiny"
                style="margin:0 0.5em; padding:0.5em;"
                ng-click="cloneForm()"
          >
            Clone 
          </span>
        </div>
      </div>  
    </div>  
      <div class="row">
        <div ng-if="widget.form.config.cloned" class="column small-12" style="font-size: small;">
          Cloned from: #{{widget.form.config.cloned}}
        </div>
      </div>
      <div class="row">
        <div class="column small-12" style="font-size: small;">
          Created at: {{formatDate(widget.form.createdAt)}}
        </div>
      </div>
      <div class="row">
        <div class="column small-12" style="font-size: small;">
          Last update: {{formatDate(widget.form.updatedAt)}}
        </div>
      </div>
      <hr/>
      <h4>
      Metadata  
    </h4>
      <div class="row">
        <div class="column small-12">
          <div class="column small-3 left">
            <label class="large">Key</label>
          </div>
          <div class="column small-8 left">
            <label class="large">Value</label>
          </div>
        </div>
      </div>
      <div ng-repeat="m in metadataTools.metadata" class="row">
        <div class="column small-12">
          <div class="column small-3 left">
            <input style="margin-bottom: 0.25em;" type="text" ng-model="m.key" ng-value="m.key" ng-disabled="true">
          </div>
          <div class="column small-8 left">
            <input style="margin-bottom: 0.25em;" type="text" ng-model="m.value" ng-value="m.value" ng-disabled="!m.editable">
          </div>
          <div class="column small-1" style="padding: 0.25em;">
            <button ng-if="!m.required" ng-click="metadataTools.delete(m.key)" style=" color: #5f8ab9;
                            background: none;
                            font-size: xx-large;
                            padding: 0;
                            margin: 0;
                            cursor: pointer;">
              <i class="fa fa-times" />
            </button>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="column small-12">
          <div class="column small-3 left">
            <input style="margin-bottom: 0.25em;" type="text" ng-model="textFields.key" ng-value="textFields.key">
          </div>
          <div class="column small-8 left">
            <input style="margin-bottom: 0.25em;" type="text" ng-model="textFields.value" ng-value="textFields.value">
          </div>
          <div class="column small-1" style="padding: 0.25em;">
            <button ng-click="metadataTools.add(textFields.key, textFields.value)" 
                    style=" color: #5f8ab9;
                            background: none;
                            font-size: xx-large;
                            padding: 0;
                            margin: 0;
                            cursor: pointer;
                            border:none;
                            outline:none;" 
                    ng-disabled="!metadataTools.valid()"
            >
              <i class="fa fa-plus-circle" />
            </button>
          </div>
        </div>
      </div>
      <hr/>
      <h4>
        Access   
      </h4>
      <div class="row">
        <div class="column small-12">
          <div class="column small-3 left">
            <a  class="button split tiny" 
                style="   background-color: #5f8ab9;
                          color: #e7e7e7;
                          font-size: large;"
            >
              {{accessTypes[widget.form.config.access.type]}}
              <span dropdown-toggle="{{'#'+widget.ID+'_access_type'}}"/>
            </a>
            <ul id="{{widget.ID+'_access_type'}}" class="f-dropdown">
              <li><a ng-click="setAccessType('any')">For any respondents</a></li>
              <li><a ng-click="setAccessType('users')">For logged users</a></li>
              <li><a ng-click="setAccessType('invited')">For invited respondents</a></li>
            </ul>
          </div>
          <div class="column small-4 left" style="margin: 0.5em;"

          >
            <label class="large left" style="margin-right: 1em;">
              Access {{(widget.form.config.access.enabled)? "was opened": "was closed" }} 
              <span ng-if="widget.form.config.access.lastNotificatedAt">
                ({{timeAgo(widget.form.config.access.lastNotificatedAt)}})
              </span>  
            </label>
            <div class="switch tiny radius left">
              <input  type="checkbox" 
                      id="{{widget.instanceName+'_access_enabled'}}" 
                      ng-model="widget.form.config.access.enabled"
                      ng-click = "userNotification()"
              >
              <label for="{{widget.instanceName+'_access_enabled'}}"
                       
              ></label>

            </div>
          </div>
        </div>
      </div>

      <hr/>
       <hr/>
      <div ng-if="widget.form.config.access.type == 'invited'">
        <h4>Invited respondents</h4>
            
        <table style="border:none;">
          <tr style="background:#e7e7e7;">
            <td colspan="3" style="border:none; font-size: x-small;">
              Respondent
            </td>
            <td colspan="2" style="border:none; font-size: x-small;">
              Notified at
            </td>  
          </tr>  
          <tr ng-repeat="u in widget.form.config.access.users">
            <td style="border:none;">
                <i>
                  <span  ng-if="u.find" 
                      class="fa fa-spinner fa-pulse"
                      style=" font-size: 1em;
                              padding: 0 0 0 0.16em;
                              color: #cedded;"
                  />
                  <span   style=" 
                      background-image: url({{u.photo}});
                      background-size: 3em 3em;
                      border-radius: 50%;
                      display: block;
                      overflow: hidden;
                      position: relative;
                      height: 3em;
                      width: 3em;
                      float: left;
                      "
                      ng-if="u.photo && !u.find"></span>
                  <span ng-if="!u.photo && !u.find" style="float: left; margin: 0 0 0 -0.4em;">
                        <i  class="fa fa-user-circle"
                            style="     font-size: 2.75em;
                                        padding: 0 0 0 0.16em;
                                        color: #cedded;"
                        >
                          
                        </i></span>
                </i>
            </td>
            <td style="border:none;">
                <a href="mailto:{{u.email}}" target="blank" style="font-size: large;">  
                  {{(u.name)? u.name : u.email}}
                </a>  
            </td>

            <!-- <td style="border:none; font-size:x-small">
              {{u.apikey}}
            </td>   -->
            
            <td   style=" border:none; 
                          font-size: large; 
                          color:#5f8ab9; 
                          cursor:pointer;"
            >
                <i  ng-click="userUtils.editInvitedUser(u)"  
                    ng-if="!u.id" class="fa fa-address-card"/>
                <i ng-if="u.id">&nbsp;</i>
            </td>

            <td style="border:none; font-size: x-small;" ng-if="u.notifiedAt">
              <!-- <i class="fa fa-external-link"/> -->
              {{timeAgo(u.notifiedAt)}}
            </td>
            <td style="border:none; font-size: x-small;" ng-if="!u.notifiedAt">
              <!-- <i class="fa fa-external-link"/> -->
              <!-- {{formatDate(u.notifiedAt)}} -->
              &nbsp;
            </td>  
            
            <td style="border:none; font-size: large; color:#5f8ab9; cursor:pointer;"
                ng-click="userUtils.deleteInvitedUser(u.email)"  
            >
                <i class="fa fa-times"/>
            </td>
            
          </tr>
          <tr style="border:none;">
            <td style="border:none;" colspan="2">
              <div class="row" style="padding: 0; margin:2em 0 0 0;">
                  <div  ng-if="userUtils.userIsInvited" 
                        style="font-size: smaller; color: #f08a24; margin:-1.5em 1em;"
                  >
                    <i class="fa fa-exclamation-triangle" style="margin:0 0.5em;" />already invited
                  </div>
                  <div  ng-if="!userUtils.userIsInvited" 
                        style="font-size: smaller; color: #f08a24; margin:-1.5em 1em;"
                  >
                    &nbsp;
                  </div>
                  <div class="column small-12 left" style="padding:0;">



                    <md-content class="md-padding">
                      <md-autocomplete
                          md-selected-item="selectedUser"
                          md-search-text="invitedUser"
                          md-items="item in userUtils.getUsers(invitedUser)"
                          md-selected-item-change="userUtils.validInvitedUser(item)"
                          md-search-text-change="userUtils.validInvitedUser(invitedUser)"
                          md-item-text="item.email"
                          md-min-length="0"
                          placeholder="Respondent's email">
                        <md-item-template>
                          <img src="{{item.photo}}" style="width:2em; height:2em;"/>
                          <span md-highlight-text="invitedUser" md-highlight-flags="^i">
                            {{item.name}}
                          </span>
                        </md-item-template>
                        <md-not-found>
                          <span style="
                                color:{{(userUtils.invitedUserIsValid && !userUtils.userIsInvited)?'#5f8ab9':'#f08a24'}};
                                font-size:small;
                          ">
                            {{validationMessage}}
                          </span>  
                        </md-not-found>
                      </md-autocomplete>
                    </md-content>
                    




                     <!-- <input   type="text" 
                              ng-model="invitedUser" 
                              ng-change="userUtils.validInvitedUser(invitedUser)" 
                              placeholder="Enter user email" 
                              typeahead="cu as cu.email for cu in userUtils.getUsers($viewValue)" typeahead-template-url="/widgets/v2.form/userShortInfo.html" 
                              class="form-control"  
                              typeahead-on-select="userUtils.validInvitedUser(invitedUser)"
                    > -->
                  </div>
              </div>    
            </td>
            <td style="border:none;">
                    <button   ng-click="userUtils.addInvitedUser()" 
                              style="     color: #5f8ab9;
                                          background: none;
                                          font-size: xx-large;
                                          padding: 1em 0 0.5em 0;
                                          margin: 0;
                                          cursor: pointer;
                                          border: none;
                                          outline: none;""
                              ng-disabled="!userUtils.invitedUserIsValid || userUtils.userIsInvited"
                    >
                      <i class="fa fa-user-plus" />
                    </button>
                  
            </td>  
          </tr>  
        </table>
        <hr/>
      </div>
      <h4>
        Responses
        
          <span class="button tiny"
                  style="margin:0 0.5em; padding:0.5em;"
                  ng-click="exportResponses()"
            >
              Export CSV 
          </span>
             
      </h4>
      <!-- <pre>{{responsesStat}}</pre> -->
      <div class="row">
        <div class="column small-12">
          <table  style="
                    box-shadow: 0 0.1em 0.5em 0 #607D8B;
                    margin: 0 auto;" 
                  ng-if="responseDynamic"
          >
          <tr>
            <td   style="
                        border: none;
                        color: #777;
                        text-align: center;
                        font-size: larger;" 
                  colspan="{{responseDynamic.length}}"
            >
              Total: {{responsesStat.length}} responses
            </td>
          </tr>    
          <tr>
            <td ng-repeat="v in responseDynamic track by $index" 
              style="border: none; 
                  width:2em;
                  "
            >
                <div style="font-size: xx-small;
                                    text-align: center;
                                    height:1em;
                                    line-height: 1em;
                                    color:#777;
                                    "
                        >
    {{(responseDynamic[$index].value>0) ? ((100*responseDynamic[$index].value).toFixed(0)+'%') :' '}}
                      </div>
            </td> 
          </tr>
          <tr>
            <td ng-repeat="v in responseDynamic track by $index" 
              style="border: none; 
                  width:2em;
                  "
            > 
              <div style="height:5em;">
                  <div       
                            style=" 
                     background:#03a9f4;
                     border:0.05rem solid {{(responseDynamic[$index].value>0)?'#03a9f4':'#999'}};
                                    position:relative;
                                    height:{{5*responseDynamic[$index].height}}em;
                                    top:{{5*(1-responseDynamic[$index].height)}}em; 
                                  "
                        >
                        </div>
                    </div>  
            </td>
          </tr>
          <tr>
            <td ng-repeat="v in responseDynamic track by $index" 
              style="border: none; 
                  width:2em;
                  "
            >    
              <div  
                        style=" 
                                text-align: center;
                                
                                line-height: 1em;
                                color:#777; 
                                font-size: xx-small;
                              "
                      >
                        {{responseDynamic[$index].title}}
                      </div>
            </td>
          </tr>   
        </table>
          <!-- <table style="border:none">
            <tr>
              <td style="border:none;">
                Starts: 
              </td>
              <td style="border:none;">
                {{timeAgo(responsesStat[0].date)}}
              </td> 
            </tr>
            <tr>
              <td style="border:none;">
                Last response: 
              </td>
              <td style="border:none;">
                {{timeAgo(responsesStat[responsesStat.length-1].date)}}
              </td> 
            </tr>
            <tr>
              <td style="border:none;">
                Total: 
              </td>
              <td style="border:none;">
                {{responsesStat.length}} response(s)
              </td> 
            </tr> 
          </table> -->
        </div>
      </div>    
<!--       <div class="row" ng-if="widget.form.config.access.type == 'invited'">
        <div class="column small-12">
          <div class="column small-3 left">
            <label class="large left" style="margin-right: 1em;">
              Invite respondents when the form starts for the first time 
            </label>
            <div class="switch tiny radius left">
              <input type="checkbox" ng-disabled="widget.form.config.access.enabled" id="{{widget.instanceName+'_invU_enabled'}}" ng-model="widget.form.config.access.invitationEnabled">
              <label for="{{widget.instanceName+'_invU_enabled'}}"></label>
            </div>
          </div>
          <div ng-if="widget.form.config.access.invitationEnabled" class="column small-9">
            <label class="large">Invitation template </label>
            <textarea   class="text" 
                        rows=5 
                        ng-model="widget.form.config.access.invitationTemplate" 
                        ng-disabled="widget.form.config.access.enabled"
            ></textarea>
          </div>
        </div>
      </div>
      <div class="row" ng-if="widget.form.config.access.type == 'invited'">
        <div class="column small-12">
          <div class="column small-3 left">
            <label class="large left" style="margin-right: 1em;">
              Notify respondents when the form changes state
            </label>
            <div class="switch tiny radius left">
              <input  type="checkbox" 
                      ng-disabled="widget.form.config.access.enabled" 
                      id="{{widget.instanceName+'_notU_enabled'}}" 
                      ng-model="widget.form.config.access.notificationEnabled"
              >
              <label for="{{widget.instanceName+'_notU_enabled'}}"></label>
            </div>
          </div>
          <div ng-if="widget.form.config.access.notificationEnabled" class="column small-9">
            <label class="large">Notification template </label>
            <textarea   class="text" 
                        rows=5 
                        ng-model="widget.form.config.access.notificationTemplate" 
                        ng-disabled="widget.form.config.access.enabled"
            ></textarea>
          </div>
        </div>
      </div> -->
     
    </div>
  </div>
</div>

<!-- Notify users when the form changes state
Invite users when the form starts for the first time
Users can add alternatives
access is open
other
the form is completed. save changes
You can save the answer. But 2 out of 3 answers are not completed
You added an alternative to the question. Click to save changes.
Changes saved successfully
saving changes...
the form is started in test mode
your alternative

notification template
invitation template

process responses for this form


page and form mismatch
leave as is


Requires sign in:
Limit to 1 response
Respondents can:
Edit after submit
See summary charts and text responses -->