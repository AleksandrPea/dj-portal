{"version":3,"sources":["v2.topbar/widget.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,kBAAkB,UAAU,KAAK,EAAE,OAAO,OAAO,IAAI,aAAa,IAAI,aAAa;;AAEvF,IAJO,UAAO,gBAAA,QAAM;;AAGpB,IAAI,IAAI,QAAQ,OAAO,yBAAyB;;AAEhD,EAAE,QAAQ,gBAAgB,YAAU;EAClC,OAAO,YAAA;IAIL,OAJY,KAAK,SAAS,SAAS,IAAI,UAAU;;;;AAGrD,EAAE,WAAW,sHAA0B,UACrC,QACA,gBACA,QACA,SACA,aACA,SACA,cAAa;;EAGb,QAAQ,OAAO,QAAO;;IAEpB,SAAW,QAAQ,KAAK,YAAY,OAAO,QAAQ;IACnD,YAAc,QAAQ,KAAK,YAAY,OAAO;;IAE9C,OAAK,SAAA,QAAE;MACL,YAAY,OAAO,UAAU,QAAQ,KAAK,OAAO,SAAS;MAC1D,YAAY,OAAO,aAAa,QAAQ,KAAK,OAAO;MACpD,eAAe;;;IAGjB,QAAM,SAAA,SAAE;MACN,eAAe;;;IAGjB,YAAU,SAAA,aAAE;MACV,OAAO;QACH,OAAM;QACN,QAAO,EAAE,OAAM,EAAC,OAAM,iBAAgB,OAAM,IAAG,UAAS,MAAK,UAAS;SACvE,KAAK,UAAS,MAAK;QACpB,OAAO,QAAQ,KAAK;UAClB,KAAK;UACL,OAAO,KAAK,OAAO,MAAM;UACzB,SAAS;;;;;IAKf,eAAa,SAAA,cAAA,SAAS;MACpB,IAAI,IAAI,OAAO,QAAQ,OAAO,UAAC,MAAI;QAFjC,OAEuC,KAAK,OAAO,QAAQ;SAAM;MACnE,IAAG,GAAE;QACH,QAAQ,oBAAkB,EAAE,QAAM,MAAI,EAAE,MAAI,KAC3C,KAAK,YAAM;UACV,OAAO,UAAU,OAAO,QAAQ,OAAQ,UAAC,MAAI;YAD3C,OACgD,KAAK,OAAO,EAAE;;;;;;IAKtE,aAAW,SAAA,YAAA,SAAS;MAClB,IAAI,IAAI,OAAO,QAAQ,OAAO,UAAC,MAAI;QACjC,OADuC,KAAK,OAAO,QAAQ;SAAM;MACnE,IAAG,GAAE;QACH,OAAO;UACH,OAAM;UACN,QAAO;YACL,OAAM;cACJ,OAAM,iBAAgB,OAAM,EAAE,OAAM,UAAS,MAAK,UAAS;;;WAGhE,KAAK,UAAS,MAAK;UACpB,EAAE,QAAQ,KAAK,OAAO,MAAM;;;;;IAKlC,SAAO,SAAA,QAAA,SAAS;MACd,IAAG,SAAQ;QAGT,CAAC,YAAY;UAFb,IAAI,IAAI,OAAO,QAAQ,OAAO,UAAC,MAAI;YAI/B,OAJqC,KAAK,OAAO,QAAQ;aAAM;UACnE,IAAG,GAAE;YACH,OAAO;cACH,OAAM;cACN,QAAO;gBACL,OAAM,EAAC,OAAM,cAAa,OAAM,IAAG,UAAS,MAAK,UAAS;gBAC1D,MAAK,EAAC,OAAM,kBAAiB,OAAM,IAAG,UAAS,MAAK,UAAS;;eAGlE,KAAK,UAAS,MAAK;cAClB,EAAE,QAAQ,KAAK;gBACb,KAAK;gBACL,OAAO,KAAK,OAAO,MAAM;gBACzB,MAAM,KAAK,OAAO,KAAK;;;;;aAI1B;QACD,OAAO;UACH,OAAM;UACN,QAAO;YACL,OAAM,EAAC,OAAM,cAAa,OAAM,IAAG,UAAS,MAAK,UAAS;YAC1D,MAAK,EAAC,OAAM,kBAAiB,OAAM,IAAG,UAAS,MAAK,UAAS;;WAGlE,KAAK,UAAS,MAAK;UAClB,OAAO,QAAQ,KAAK;YAClB,KAAK;YACL,OAAO,KAAK,OAAO,MAAM;YACzB,MAAM,KAAK,OAAO,KAAK;;;;;;IAMjC,YAAU,SAAA,WAAA,MAAA,SAAc;MACtB,IAAG,SAAQ;QAKT,CAAC,YAAY;UAJb,IAAI,IAAI,OAAO,QAAQ,OAAO,UAAC,MAAI;YAM/B,OANqC,KAAK,OAAO,QAAQ;aAAM;UACnE,IAAG,GAAE;YAQD,CAAC,YAAY;cAPf,IAAI,KAAK,EAAE,QAAQ,OAAQ,UAAC,GAAC;gBASvB,OAT4B,EAAE,OAAO,KAAK;iBAAM;cACtD,IAAG,IAAG;gBACJ,QAAQ,iBAAe,GAAG,QAAM,MAAI,GAAG,MAAI,KAC1C,KAAK,YAAM;kBACV,EAAE,UAAU,EAAE,QAAQ,OAAQ,UAAC,GAAC;oBAU1B,OAV+B,EAAE,OAAO,GAAG;;;;;;;aAIpD;QAcH,CAAC,YAAY;UAbb,IAAI,KAAK,OAAO,QAAQ,OAAQ,UAAC,GAAC;YAe9B,OAfmC,EAAE,OAAO,KAAK;aAAM;UAC3D,IAAG,IAAG;YACJ,QAAQ,iBAAe,GAAG,QAAM,MAAI,GAAG,MAAI,KAC1C,KAAK,YAAM;cACV,OAAO,UAAU,OAAO,QAAQ,OAAQ,UAAC,GAAC;gBAgBtC,OAhB2C,EAAE,OAAO,GAAG;;;;;;;;IAMnE,QAAM,SAAA,OAAA,MAAA,SAAe;MACnB,IAAI,OAAO,UAAW,QAAQ,UAAU,OAAO;MAC/C,IAAI,KAAK,KACN,IAAI,UAAC,MAAK,OAAU;QAAC,OAAO,EAAC,OAAQ,OAAM,MAAO;SAClD,OAAO,UAAC,GAAC;QAmBV,OAnBgB,EAAE,KAAK,OAAO,KAAK;SAAK;MAC1C,IAAI,QAAS,KAAK,GAAG,QAAQ,CAAC;MAC9B,IAAG,QAAQ,GAAE;QACX,IAAI,MAAM,KAAK,QAAM;QACrB,KAAK,QAAM,KAAK,KAAK;QACrB,KAAK,SAAS;;;;IAIlB,UAAQ,SAAA,SAAA,MAAM;MACZ,OAAO;QACH,OAAM;QACN,QAAO;UACL,OAAM,EAAC,OAAM,cAAa,OAAM,KAAK,OAAM,UAAS,MAAK,UAAS;UAClE,MAAK,EAAC,OAAM,kBAAiB,OAAM,KAAK,MAAK,UAAS,MAAK,UAAS;;SAGzE,KAAK,UAAS,MAAK;;QAEhB,KAAK,QAAQ,KAAK,OAAO,MAAM;QAC/B,KAAK,OAAO,KAAK,OAAO,KAAK;;;;;;AASvC,EAAE,WAAW,mNAAoB,UACzB,QACA,QACA,KACA,OACA,SACA,QACA,QACA,MACA,aACA,YACA,SACA,cACA,MACA,cACA,SACA,WACA,SAAQ;;EAIZ,IAAM,eAAe,IAAI,aAAa;EACtC,QAAQ,OAAO,QAAQ;IACnB,OAAA;IACA,KAAA;IACA,SAAA;IACA,QAAA;;IAEA,UAAS,UAAC,MAAS;MACjB,IAAI,OAAO,KAAK,MAAM;MACtB,IAAI,OAAO,KAAM,GAAG,SAAO,IAAK,KAAK,KAAK,UAAU;MACpD,IAAI,KAAK,KAAK;;MAEd,IAAG,QAAQ,UAAU,UAAU,IAAG;QAChC,QAAQ;QACR;;;MAGF,IAAG,KAAK,SAAO,KAAK,QAAQ,UAAU,QAAO;QAC3C,QAAQ,SAAS,OAAO;;;;IAK5B,WAAW,CACT,EAAC,KAAK,MAAM,OAAO,UACnB,EAAC,KAAK,MAAM,OAAO;;;IAGrB,gBAAc,SAAA,eAAA,SAAU;MACtB,OAAO,cAAc,OAAO,UAAU,OAAO,UAAC,MAAI;QALpD,OAKyD,KAAK,OAAO;SAAS;MAC5E,WAAW,IAAI;MACf,WAAW,UAAU,KAAK,YAAM;QAAC,KAAK;;MACtC,aAAa,KAAK,kBAAiB;;;EAI1C,OAAO,cAAc,OAAO,UAAU,OAAO,UAAC,MAAI;IAFjD,OAEsD,KAAK,OAAO,KAAK;KAAU;;EAElF,IAAI,YAAY,QACd,OAAQ,YAAM;;IAEb,OAAO,OAAO,aAAc,OAAO,OAAO,aAAc,OAAO,OAAO,aACpE;MACE,kBAAmB;QACjB,QAAO;QACP,UAAS;QACT,WAAU;;MAEZ,aAAY;MACZ,UAAW;;IAEf,OAAO,OAAO,UAAU,OAAQ,OAAO,UAAW,OAAO,OAAO,UAAU;IAC1E,QAAQ,IAAI,eAAe,OAAO,YAAY;IAC9C,OAAO,eAAe,OAAO,YAAY;KAwC1C,mBAAmB,YAAY;IAC7B,OAAO,KAAK;MACT,aAAa;MACb,YAAY;MACZ,SAAS;QACP,SAAS,YAAA;UAzCX,OAyCiB,OAAO,OAAO;;QAC7B,aAAa,YAAA;UAvCf,OAuCqB;;;MAErB,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAUf","file":"v2.topbar/widget.js","sourcesContent":["import angular from 'angular';\r\n\r\n\r\nlet m = angular.module('app.widgets.v2.topbar', []);\r\n\r\nm.service(\"randomItemID\", function(){\r\n  return () =>  Math.random().toString(36).substring(2)\r\n})\r\n\r\nm.controller(\"TopBarDialogController\", function(\r\n  $scope,\r\n  $modalInstance,\r\n  dialog,\r\n  content,\r\n  parentScope,\r\n  confirm,\r\n  randomItemID){\r\n\r\n  \r\n  angular.extend($scope,{\r\n    \r\n    \"content\": angular.copy(parentScope.widget.content.reverse()),\r\n    \"decoration\": angular.copy(parentScope.widget.decoration),\r\n\r\n    close(){\r\n      parentScope.widget.content = angular.copy($scope.content).reverse();\r\n      parentScope.widget.decoration = angular.copy($scope.decoration);\r\n      $modalInstance.close();\r\n    },\r\n\r\n    cancel(){\r\n      $modalInstance.dismiss();\r\n    },\r\n\r\n    addSection(){\r\n      dialog({\r\n          title:\"New Section\",\r\n          fields:{ title:{title:\"Section Title\",value:\"\",editable:true,required:true}} \r\n      }).then(function(form){\r\n        $scope.content.push({\r\n          key: randomItemID(),\r\n          title: form.fields.title.value,\r\n          content: []\r\n        })\r\n      })\r\n    },\r\n\r\n    deleteSection(section){\r\n      let s = $scope.content.filter((item) =>  item.key == section.key )[0]\r\n      if(s){\r\n        confirm(\"Delete section \"+s.title+\"(\"+s.key+\")\")\r\n        .then(() => {\r\n          $scope.content = $scope.content.filter( (item) => item.key != s.key )\r\n        })\r\n      }\r\n    },\r\n\r\n    editSection(section){\r\n      let s = $scope.content.filter((item) =>  item.key == section.key )[0]\r\n      if(s){\r\n        dialog({\r\n            title:\"Edit Section\",\r\n            fields:{ \r\n              title:{\r\n                title:\"Section Title\",value:s.title,editable:true,required:true\r\n              }\r\n            } \r\n        }).then(function(form){\r\n          s.title = form.fields.title.value; \r\n        })\r\n      }  \r\n    },\r\n\r\n    addItem(section){\r\n      if(section){\r\n        let s = $scope.content.filter((item) =>  item.key == section.key )[0]\r\n        if(s){\r\n          dialog({\r\n              title:\"New Item\",\r\n              fields:{ \r\n                title:{title:\"Item Title\",value:\"\",editable:true,required:true},\r\n                href:{title:\"Item Reference\",value:\"\",editable:true,required:true}\r\n              } \r\n          })\r\n          .then(function(form){\r\n            s.content.push({\r\n              key: randomItemID(),\r\n              title: form.fields.title.value,\r\n              href: form.fields.href.value\r\n            })\r\n          })\r\n        }\r\n      }else{\r\n          dialog({\r\n              title:\"New Item\",\r\n              fields:{ \r\n                title:{title:\"Item Title\",value:\"\",editable:true,required:true},\r\n                href:{title:\"Item Reference\",value:\"\",editable:true,required:true}\r\n              } \r\n          })\r\n          .then(function(form){\r\n            $scope.content.push({\r\n              key: randomItemID(),\r\n              title: form.fields.title.value,\r\n              href: form.fields.href.value\r\n            })\r\n          })\r\n      }\r\n    },\r\n\r\n    deleteItem(item,section){\r\n      if(section){\r\n        let s = $scope.content.filter((item) =>  item.key == section.key )[0]\r\n        if(s){\r\n          let it = s.content.filter( (p) => p.key == item.key )[0]\r\n          if(it){\r\n            confirm(\"Delete item \"+it.title+\"(\"+it.key+\")\")\r\n            .then(() => {\r\n              s.content = s.content.filter( (p) => p.key != it.key )\r\n            })\r\n          }  \r\n        }\r\n      }else{\r\n        let it = $scope.content.filter( (p) => p.key == item.key )[0]\r\n        if(it){\r\n          confirm(\"Delete item \"+it.title+\"(\"+it.key+\")\")\r\n          .then(() => {\r\n            $scope.content = $scope.content.filter( (p) => p.key != it.key )\r\n          })\r\n        }\r\n      }  \r\n    },\r\n\r\n    upItem(item, section){\r\n      let list = (section)? section.content : $scope.content;\r\n      let it = list\r\n        .map((item,index) => {return {\"index\":index,\"item\":item}})\r\n        .filter((p) =>  p.item.key == item.key)[0]\r\n      let index = (it)? it.index : -1;\r\n      if(index > 0){\r\n        let buf = list[index-1];\r\n        list[index-1] = list[index];\r\n        list[index] = buf;\r\n      }  \r\n    },\r\n\r\n    editItem(item){\r\n      dialog({\r\n          title:\"Edit Item\",\r\n          fields:{ \r\n            title:{title:\"Item Title\",value:item.title,editable:true,required:true},\r\n            href:{title:\"Item Reference\",value:item.href,editable:true,required:true}\r\n          } \r\n      })\r\n      .then(function(form){\r\n        \r\n          item.title = form.fields.title.value;\r\n          item.href = form.fields.href.value;\r\n      })\r\n    }  \r\n  });\r\n\r\n  \r\n\r\n});\r\n\r\nm.controller('TopBarController', function (\r\n        $scope,\r\n        $modal,\r\n        app,\r\n        logIn,\r\n        appName,\r\n        config,\r\n        author,\r\n        user,\r\n        APIProvider,\r\n        $translate, \r\n        $lookup, \r\n        EventEmitter, \r\n        i18n,\r\n        randomItemID,\r\n        $scroll,\r\n        $location,\r\n        $window){\r\n \r\n\r\n  \r\n    const eventEmitter = new EventEmitter($scope);\r\n    angular.extend($scope, {\r\n        logIn,\r\n        app,\r\n        appName,\r\n        config,\r\n        \r\n        navigate:(href) => {\r\n          let href = href.split('#');\r\n          let path = (href[0].length>0) ? href[0] : $location.path();\r\n          let id = href[1];\r\n          \r\n          if(path == $location.path() && id){\r\n            $scroll(id)\r\n            return\r\n          } \r\n\r\n          if(path.length>0 && path != $location.path()){\r\n            $window.location.href = path;  \r\n          }\r\n\r\n        },\r\n\r\n        languages: [\r\n          {key: \"en\", title: \"Eng.\"},\r\n          {key: \"uk\", title: \"Укр.\"}\r\n          // {key: \"ru\", title: \"Рус.\"}\r\n        ],\r\n        selectLanguage(langKey) {\r\n          $scope.currentLang = $scope.languages.filter((item) => item.key == langKey)[0]\r\n          $translate.use(langKey);\r\n          $translate.refresh().then(() => {i18n.refresh()});\r\n          eventEmitter.emit(\"selectLanguage\",langKey);\r\n        },\r\n    });    \r\n   \r\n   $scope.currentLang = $scope.languages.filter((item) => item.key == i18n.locale())[0];\r\n   \r\n   new APIProvider($scope)\r\n    .config( () => {\r\n    \r\n      $scope.widget.decoration = ($scope.widget.decoration) ? $scope.widget.decoration :\r\n        {\r\n          languageSelector : {\r\n            enable:true,\r\n            showFlag:false,\r\n            showTitle:true\r\n          },\r\n          loginButton:true,\r\n          gotoApps : true\r\n        };\r\n      $scope.widget.content = ($scope.widget.content) ? $scope.widget.content : [];\r\n      console.log(\"Select lang\", $scope.currentLang.key)\r\n      $scope.selectLanguage($scope.currentLang.key)\r\n      // eventEmitter.emit(\"selectLanguage\",$scope.currentLang.key);\r\n      \r\n      //   [ {\r\n      //        key:randomItemID(),\r\n      //       title: \"Getting Started\",\r\n      //       href: \"#Getting\",\r\n      //       content: [{\r\n      //          key: randomItemID(),\r\n      //           title: \"Page 1\",\r\n      //           href: \"#p1\"  \r\n      //         },{\r\n      //            key: randomItemID(),\r\n      //           title: \"Page 2\",\r\n      //           href: \"#p2\"  \r\n      //         }\r\n      //       ]\r\n      //     },\r\n      //     {\r\n      //        key:randomItemID(),\r\n      //       title: \"Pages\",\r\n      //       content: [{\r\n      //          key: randomItemID(),\r\n      //           title: \"Page 1\",\r\n      //           href: \"#p1\"  \r\n      //         },{\r\n      //            key: randomItemID(),\r\n      //           title: \"Page 2\",\r\n      //           href: \"#p2\"  \r\n      //         }\r\n      //       ]\r\n      //     },{\r\n      //        key: randomItemID(),\r\n      //       title: \"About\",\r\n      //       href: \"#Getting\"\r\n      //     }          \r\n      // ];\r\n      // $scope.widget.content = $scope.widget.content.reverse();\r\n\r\n    })\r\n    .openCustomSettings(function () {\r\n       $modal.open({\r\n          templateUrl: \"/widgets/v2.topbar/topbar-dialog.html\",\r\n          controller: 'TopBarDialogController',\r\n          resolve: {\r\n            content: () => $scope.widget.content,\r\n            parentScope: () => $scope\r\n          },\r\n          backdrop: 'static'\r\n       })\r\n    })\r\n\r\n    // .translate((langKey) => {\r\n    //   $scope.currentLang = $scope.languages.filter((item) => item.key == langKey)[0]\r\n    // })\r\n    // .provide('selectLanguage', (langKey) => {\r\n    //   console.log(\"selectLang\",langKey)\r\n    //   $scope.currentLang = $scope.languages.filter((item) => item.key == langKey)[0]\r\n    // })\r\n\r\n    \r\n    \r\n});\r\n\r\n\r\n  "],"sourceRoot":"/source/"}