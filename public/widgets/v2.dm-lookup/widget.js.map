{"version":3,"sources":["v2.dm-lookup/widget.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,kBAAkB,UAAU,KAAK,EAAE,OAAO,OAAO,IAAI,aAAa,IAAI,aAAa;;AAEvF,IAJO,UAAO,gBAAA,QAAM;;AAMpB,QALO;;AAGP,QAAQ,OAAO,4BAA4B,CAAC,mBACzC,WAAW,0GAAiC,UAAU,QACrD,OACA,cACA,aACA,SACA,SAAS;;EAET,OAAO,MAAM;EACb,OAAO,aAAa;EACpB,IAAM,eAAe,IAAI,aAAa;;EAEtC,IAAI,YAAY,QACb,OAAO,YAAM;IACZ,QAAQ,IAAG,YAAW,OAAO,OAAO,eAAY;IAChD,OAAO,QAAQ,OAAO,OAAO;IAC7B,OAAO,aAAa,OAAO,OAAO;IAClC,IAAG,OAAO,KAAI;MACZ,OAAO,SAAS,QAAQ,OAAO;WAC5B;MACH,OAAO,SAAS;;KAGnB,QAAQ,gBAAgB,UAAC,KAAK,OAAO,KAAQ;IAC5C,QAAQ,IAAI,gBAAgB,OAAO;IACnC,IAAG,QAAQ,UAAU,QAAO;MAC1B,OAAO,MAAM;MACb,OAAO,aAAa;;MAEpB,QAAQ,OAAO,OAAO;;MAEtB,OAAO,MAAM;MACb,IAAI,MAAM,QAAQ,OAAO;MACzB,IAAG,OAAO,OAAO,OAAO,IAAI,IAAG;QAC7B,OAAO,SAAS,EAAC,OAAM,OAAO,KAAK,UAAS;QAC5C,OAAO,OAAO;aACX;QACH,OAAO,SAAS;QAChB,OAAO,OAAO,WAAW;QACzB,OAAO,OAAO,QAAQ,OAAO,OAAO,SAAS,OAAO,OAAO;QAC3D,OAAO,OAAO;QACd,IAAI,OAAO,OAAO,KAAK,OAAO;QAC9B,KAAI,IAAI,IAAE,GAAG,IAAE,KAAK,QAAO,KAAI;UAC7B,OAAO,KAAK,KAAK,EAAC,KAAI,KAAK,IAAI,OAAM,OAAO,OAAO,KAAK;;;;WAIzD;MACH,OAAO,OAAO;MACd,OAAO,aAAa;;KAKvB,QAAQ,mBAAmB,UAAC,KAAK,OAAU;IAC1C,OAAO,aAAa;KAGrB,QAAQ,YAAM;IACb,QAAQ,IAAI;;IAEf","file":"v2.dm-lookup/widget.js","sourcesContent":["import angular from 'angular';\r\nimport 'dictionary';\r\n\r\n\r\nangular.module('app.widgets.v2.dm-lookup', ['app.dictionary'])\r\n  .controller('V2DataManagerLookupController', function ($scope, \r\n    $http, \r\n    EventEmitter, \r\n    APIProvider, \r\n    $lookup,\r\n    $scroll) {\r\n    \r\n    $scope.key = undefined; \r\n    $scope.visibility = true;\r\n    const eventEmitter = new EventEmitter($scope);\r\n\r\n    new APIProvider($scope)\r\n      .config(() => {\r\n        console.log(`widget ${$scope.widget.instanceName} is (re)configuring...`);\r\n        $scope.title = $scope.widget.title;\r\n        $scope.icon_class = $scope.widget.icon_class;\r\n        if($scope.key){\r\n          $scope.object = $lookup($scope.key);\r\n        }else{\r\n          $scope.object = undefined;\r\n        }\r\n      })\r\n      .provide('setLookupKey', (evt, value, cat) => {\r\n        console.log(\"setLookupKey\", value, cat)\r\n        if(angular.isDefined(value)){\r\n          $scope.fml = false;\r\n          $scope.visibility = true;\r\n\r\n          $scroll($scope.widget.instanceName)\r\n          \r\n          $scope.key = value;\r\n          let tmp = $lookup($scope.key);\r\n          if($scope.key == tmp || tmp.en){\r\n            $scope.object = {label:$scope.key, category:cat};\r\n            $scope.meta = [];\r\n          }else{\r\n            $scope.object = tmp;\r\n            $scope.object.category = cat;\r\n            $scope.object.label = $scope.object.label || $scope.object[\"Short Name\"] \r\n            $scope.meta = [];\r\n            var keys = Object.keys($scope.object);\r\n            for(var i=0; i<keys.length;i++){\r\n              $scope.meta.push({key:keys[i], value:$scope.object[keys[i]]})\r\n            }\r\n            // console.log($scope.meta)\r\n          }\r\n        }else{\r\n          $scope.meta = [];\r\n          $scope.visibility = false;\r\n        }\r\n        \r\n      })\r\n      \r\n      .provide(\"slaveVisibility\", (evt, value) => {\r\n        $scope.visibility = value;\r\n      })\r\n      \r\n      .removal(() => {\r\n        console.log('Lookup widget is destroyed');\r\n      });\r\n  });\r\n\r\n\r\n\r\n\r\n"],"sourceRoot":"/source/"}