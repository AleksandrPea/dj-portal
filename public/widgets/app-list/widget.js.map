{"version":3,"sources":["app-list/widget.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,kBAAkB,UAAU,KAAK,EAAE,OAAO,OAAO,IAAI,aAAa,IAAI,aAAa;;AAEvF,IAJO,UAAO,gBAAA,QAAM;;AAEpB,IAAM,gBAAgB,QAAQ,OAAO,wBAAwB;;AAE7D,cAAc,WAAW,4GAAqB,UAAU,QAAQ,OAAO,YACf,aACA,SACA,QAAQ,OAAO,MAAM;EAC3E,MAAM,IAAI,QAAQ,SAAS,QAAQ,UAAA,MAAQ;IACzC,OAAO,OAAO;IACd,OAAO,UAAU;;;EAGnB,QAAQ,OAAO,QAAQ;IACrB,MAAM;IACN,SAAS;IACT,SAAO,SAAA,QAAA,KAAM;MACX,IAAI,CAAC,KAAK,IAAI;QACZ,OAAO;;MAET,IAAI,CAAC,IAAI,OAAO;QACd,OAAO;;MAET,OAAO,IAAI,MAAM,OAAO,KAAK;;IAE/B,gBAAc,SAAA,eAAA,KAAM;MAClB,IAAI,CAAC,KAAK,IAAI;QACZ,OAAO;;MAET,IAAI,CAAC,IAAI,gBAAgB;QACvB,OAAO;;MAET,OAAO,QAAQ,YAAY,IAAI,eAAe,KAAK,UAAA,GAAC;QAElD,OAFsD,EAAE,KAAK,OAAO,KAAK;;;IAE7E,UAAQ,SAAA,WAAG;MACT,KAAK,UAAU,QAAQ,KAAK,KAAK;;IAEnC,aAAW,SAAA,cAAG;MACZ,KAAK,OAAO,KAAK;;;IAGnB,WAAS,SAAA,UAAA,OAAQ;MAIf,IAAI,QAAQ;;MAHZ,OAAM,KAAI,WAAW,QAAQ,8BAA2B,KAAK,KAAK,UAAA,YAAc;QAC9E,MAAK;QACL,MAAK,KAAK,MAAK,KAAK,UAAU,UAAA,KAAG;UAM/B,OANmC,UAAU,IAAI;YAAK,OAAO;QAC/D,MAAM,IAAI,QAAQ,IAAI,OAAO,OAAO,aACjC,MAAM,UAAC,MAAM,OAAU;UACtB,MAAK;UACL,MAAM,MAAM,WAAW,QAAQ,sCAAsC,EAAC,OAAA,OAAO,MAAA;;;;;IAKrF,WAAS,SAAA,UAAA,OAAA,SAAiB;MAOxB,IAAI,QAAQ;;MANZ,OAAO,WAAW,QAAQ,sDAAsD,KAAK,UAAA,aAAe;QAClG,IAAI,gBAAgB,SAAS;UAC3B,MAAM,MAAM,WAAW,QAAQ;UAC/B;;;QAGF,MAAK;QACL,MAAK,KAAK,OAAO,MAAK,KAAK,UAAU,UAAA,KAAG;UAStC,OAT0C,UAAU,IAAI;YAAK;QAC/D,MAAM,IAAI,QAAQ,IAAI,QAAQ,QAAQ,MAAM,UAAC,MAAM,OAAU;UAC3D,MAAK;UACL,MAAM,MAAM,WAAW,QAAQ;;;;;;EAMvC,IAAI,YAAY,QACb,QAAQ,iBAAiB,UAAC,KAAK,KAAQ;IACtC,OAAO;IACP,OAAO,KAAK,KAAK;KAElB,sBAAsB,iBAAiB,mBACvC,sBAAsB,iBAAiB;IACzC","file":"app-list/widget.js","sourcesContent":["import angular from 'angular';\r\n\r\nconst appListWidget = angular.module('app.widgets.app-list', []);\r\n\r\nappListWidget.controller('AppListController', function ($scope, $http, $translate,\r\n                                                        APIProvider,\r\n                                                        appUrls,\r\n                                                        prompt, alert, user) {\r\n  $http.get(appUrls.appList).success(apps => {\r\n    $scope.apps = apps;\r\n    $scope.oldApps = apps;\r\n  });\r\n\r\n  angular.extend($scope, {\r\n    apps: undefined,\r\n    oldApps: undefined,\r\n    isOwner(app) {\r\n      if (!user.id) {\r\n        return false;\r\n      }\r\n      if (!app.owner) {\r\n        return true;\r\n      }\r\n      return app.owner.id === user.id;\r\n    },\r\n    isCollaborator(app) {\r\n      if (!user.id) {\r\n        return false;\r\n      }\r\n      if (!app.collaborations) {\r\n        return false;\r\n      }\r\n      return angular.isUndefined(app.collaborations.find(c => c.user.id === user.id));\r\n    },\r\n    saveApps() {\r\n      this.oldApps = angular.copy(this.apps);\r\n    },\r\n    restoreApps() {\r\n      this.apps = this.oldApps;\r\n    },\r\n\r\n    renameApp(appId) {\r\n      prompt(`${$translate.instant('WIDGET.APP-LIST.NEW_NAME')}:`).then(newAppName => {\r\n        this.saveApps();\r\n        this.apps[this.apps.findIndex(app => appId === app.id)].name = newAppName;\r\n        $http.get(appUrls.api.rename(appId, newAppName))\r\n          .error((data, error) => {\r\n            this.restoreApps();\r\n            alert.error($translate.instant('WIDGET.APP-LIST.ERROR_RENAMING_APP', {error, data}));\r\n          });\r\n      });\r\n    },\r\n\r\n    deleteApp(appId, appName) {\r\n      prompt($translate.instant('WIDGET.APP-LIST.TYPE_APP_NAME_TO_CONFIRM_DELETION')).then(confirmName => {\r\n        if (confirmName !== appName) {\r\n          alert.error($translate.instant('WIDGET.APP-LIST.WRONG_NAME_APP_NOT_DELETED'));\r\n          return;\r\n        }\r\n\r\n        this.saveApps();\r\n        this.apps.splice(this.apps.findIndex(app => appId === app.id), 1);\r\n        $http.get(appUrls.api.destroy(appId)).error((data, error) => {\r\n          this.restoreApps();\r\n          alert.error($translate.instant('WIDGET.APP-LIST.ERROR_DELETING_APP'));\r\n        });\r\n      });\r\n    }\r\n  });\r\n\r\n  new APIProvider($scope)\r\n    .provide('new-app-added', (evt, app) => {\r\n      $scope.saveApps();\r\n      $scope.apps.push(app);\r\n    })\r\n    .autoWireSlotWithEvent('new-app-added', 'new-app-created')\r\n    .autoWireSlotWithEvent('new-app-added', 'new-app-imported');\r\n});\r\n"],"sourceRoot":"/source/"}