{"version":3,"sources":["v2.steps/table-decoration.js"],"names":[],"mappings":"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","file":"v2.steps/table-decoration.js","sourcesContent":["import angular from 'angular';\r\nimport \"custom-react-directives\";\r\nimport \"wizard-directives\";\r\nimport 'ng-ace';\r\n\r\nvar m = angular.module(\"app.widgets.v2.steps.table-decoration\",[\r\n\t \"custom-react-directives\", \"wizard-directives\", 'app.dps', \"ng.ace\"]);\r\n\r\nm.factory(\"TableDecoration\",[\r\n\t\"$http\",\r\n\t\"$dps\",\r\n\t\"$q\", \r\n\t\"parentHolder\",\r\n\t\"pageWidgets\", \"i18n\", \"dialog\", \"$error\", \"dpsEditor\",\r\n\t\r\n\tfunction(\r\n\t\t$http, \r\n\t\t$dps,\r\n\t\t$q, \r\n\t\tparentHolder,\r\n\t\tpageWidgets, i18n, dialog, $error, dpsEditor){\r\n\r\n\t\t\r\n\r\n\r\n\t\treturn {\r\n\t\t\tid: \"TableDecoration\",\r\n\r\n\t\t\ttitle : \"Table Decoration\",\r\n\t\t\t\r\n\t\t\tdescription : \"Setup table decoration options\",\r\n\t        \r\n\t    \thtml : \"./widgets/v2.steps/table-decoration.html\",\r\n\r\n\t    \tonStartWizard: function(wizard){\r\n\t    \t\tthis.wizard = wizard;\r\n\t    \t\tthis.conf = {\r\n\t    \t\t\tdecoration : (wizard.conf.decoration) ? wizard.conf.decoration : {},\r\n\t    \t\t\tdataID : wizard.conf.dataID,\r\n\t    \t\t\tscript : wizard.conf.script,\r\n\t    \t\t\tqueryID : wizard.conf.queryID,\r\n\t    \t\t\tdataUrl : \"/api/data/process/\",\r\n\t    \t\t\temitters: wizard.conf.emitters\r\n\t    \t\t}\r\n\t    \t\t\r\n\t    \t\tthis.conf.decoration.setColor = (palette) => { this.conf.decoration.color = angular.copy(palette) }\r\n\t    \t\t\r\n\t    \t\tthis.conf.decoration.colorize = (this.conf.decoration.colorize) ? \r\n\t    \t\t\tthis.conf.decoration.colorize : false;\r\n\r\n\t    \t\tthis.conf.decoration.height = (this.conf.decoration.height) ? \r\n\t    \t\t\tthis.conf.decoration.height : 250;\t\r\n\t    \t\t\r\n\r\n\t    \t\tthis.conf.decoration.opacity = (this.conf.decoration.opacity) ? \r\n\t    \t\t\tthis.conf.decoration.opacity : 0.5;\r\n\t    \t\t\r\n\t    \t\tthis.conf.decoration.direction = (this.conf.decoration.direction) ? \r\n\t    \t\t\tthis.conf.decoration.direction : \"Rows\";\r\n\r\n\t    \t\tthis.queries = [{$id:'eventSource', $title:'setData(updateWithData) event'}];\r\n\t    \t\t\r\n\t    \t\tpageWidgets()\r\n\t    \t\t\t.filter((item) => item.type ==\"v2.query-manager\")\r\n\t    \t\t\t.map((item) => item.queries)\r\n\t    \t\t\t.forEach((item) => {this.queries = this.queries.concat(item)})\r\n\r\n\t    \t\tif(this.conf.queryID){\r\n\t    \t\t\tlet thos = this;\r\n\t    \t\t\tthis.inputQuery = this.queries.filter((item) => item.$id == this.conf.queryID)[0].$title;\r\n\t    \t\t}\t\r\n\r\n\t    \t\tthis.activate();\t \r\n\r\n\t    \t},\r\n\r\n\t    \tonFinishWizard:  function(wizard){\r\n\t    \t\twizard.conf.decoration = this.conf.decoration;\r\n\t    \t\twizard.conf.dataID  = this.conf.dataID; \r\n\t    \t\twizard.conf.script  = this.conf.script; \r\n\t    \t\twizard.conf.queryID = this.conf.queryID;\r\n\t    \t\twizard.conf.emitters  = this.conf.emitters;\r\n\t    \t\t\r\n\t    \t\tthis.table = undefined;\r\n\t    \t\tthis.conf = {};\r\n\t    \t},\r\n\r\n\t    \tonCancelWizard: function(wizard){\r\n\t\t\t\tthis.table = undefined;\r\n\t    \t\tthis.conf = {};\r\n\t    \t},\r\n\r\n\t    \treversePalette: function(){\r\n\t\t\t\tif ( this.conf.decoration.color ){\r\n\t\t\t\t\tthis.conf.decoration.color = this.conf.decoration.color.reverse(); \r\n\t\t\t\t}\t\r\n\t\t\t},\r\n\t\t\tselectInputData: function(){\r\n\t\t\t\tlet thos = this;\r\n      \t\t\tlet iq = this.queries.filter((item) => item.$title == thos.inputQuery)[0];\r\n\t\t\t\tthis.conf.dataID = (iq.context) ? iq.context.queryResultId: undefined;\r\n\t\t\t\tthis.conf.queryID = iq.$id;\r\n\t\t\t\tthis.loadData();\r\n\t\t\t},\r\n\r\n\t\t\tloadData: function(){\r\n\t\t\t\tlet thos = this;\r\n\t\t\t\tif(this.conf.dataID){\r\n\r\n\t\t\t\t\t$dps\r\n\t\t\t          .get(\"/api/data/process/\"+this.conf.dataID)\r\n\t\t\t          .success(function (resp) {\r\n\t\t\t              thos.wizard.context.postprocessedTable = resp.value;\r\n\t\t\t              thos.table = resp.value;\r\n\t\t\t              thos.conf.decoration.width = parentHolder(thos.wizard.conf).width;\r\n\t\t\t          })\r\n\t\t\t    }else{\r\n\r\n\t\t\t    \tif(this.conf.script){\r\n\t\t\t    \t\t$dps\r\n\t\t                    .post(\"/api/script\", {\r\n\t\t                        \"script\": this.conf.script,\r\n\t\t                        \"locale\": i18n.locale()\r\n\t\t                    })\r\n\t\t                    .then((resp) => {\r\n\t\t                    \tif (resp.data.type == \"error\") {\r\n                                $error(resp.data.data)\r\n                                return\r\n                            };\r\n\t\t                    \tthos.wizard.context.postprocessedTable = resp.data.data;\r\n\t\t\t\t              \tthos.table = resp.data.data;\r\n\t\t\t\t              \tthos.conf.decoration.width = parentHolder(thos.wizard.conf).width;\t\r\n\t\t                    })\r\n\t\t\t    \t}else{\r\n\r\n\t\t\t\t    \t$http.get(\"./widgets/v2.table/sample.json\")\r\n\t\t\t\t            .success((resp) => {\r\n\t\t\t\t            \tconsole.log(resp);  \r\n\t\t\t\t              \tthos.wizard.context.postprocessedTable = resp.value;\r\n\t\t\t\t              \tthos.table = resp.value;\r\n\t\t\t\t              \tthos.conf.decoration.width = parentHolder(thos.wizard.conf).width;\t\r\n\t\t\t\t            })\r\n\t\t\t        }    \r\n\t\t\t    }      \r\n\t\t          \r\n\t\t\t},\r\n\r\n\t\t\teditScript: function() {\r\n                var thos = this;\r\n                dpsEditor(thos.conf.script)\r\n                    .then((script) => {\r\n                        thos.conf.script = script;\r\n                        thos.loadData();\r\n                    })\r\n            },\r\n\r\n\t\t\tactivate : function(wizard){\r\n\t\t\t\t// if (this.conf.dataID) \r\n\t\t\t\t\tthis.loadData();\r\n\t\t\t}\r\n\t    }\r\n}]);    \t\r\n"],"sourceRoot":"/source/"}