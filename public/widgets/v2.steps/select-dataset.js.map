{"version":3,"sources":["v2.steps/select-dataset.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,kBAAkB,UAAU,KAAK,EAAE,OAAO,OAAO,IAAI,aAAa,IAAI,aAAa;;AAEvF,IAJO,UAAO,gBAAA,QAAM;;AAEpB,IAAI,IAAI,QAAQ,OAAO,uCAAsC,CAAC,gBAAgB;;AAE9E,EAAE,QAAQ,iBAAgB,CAAC,WAAW,SAAS,QAAQ,YAAY,WAAW,cAE5E,UAAS,SAAS,OAAO,MAAM,UAAU,SAAS,YAAW;EAC9D,OAAO;;IAEJ,IAAI;;IAEN,OAAQ;;IAER,aAAc;;IAEZ,MAAO;;IAEP,YAAY,SAAA,WAAS,MAAK;MACxB,IAAI,SAAS,WAAW,SAAS;MACjC,OAAO,IAAI,KAAK;MAChB,OAAO,KAAK,eAAe,QACzB,EAAE,MAAM;QACN,OAAO;QACP,KAAK;QACL,MAAM;QACN,QAAQ;QACR,QAAQ;;MAEZ,OAAO;;;IAGT,QAAQ;;IAGR,eAAe,SAAA,cAAS,QAAO;MAC7B,KAAK,SAAS;MACd,KAAK,OAAO;MACZ,OAAO,QAAQ;;;;;;;;;;;;;;;;;;IAkBjB,gBAAgB,SAAA,eAAS,QAAO;;IAKhC,mBAAmB,SAAA,oBAAU;MAC5B,IAAI,OAAO;MACX,KAAK,UAAU;MACd,KAAK,KAAK,uBACV,QAAQ,UAAU,MAAM;QACtB,KAAK,WAAW;QAChB,KAAK,UAAU;SAEjB,MAAM,UAAU,MAAM,QAAQ;QAC5B,QAAQ,MAAM,iBAAiB,SAAS;;;;IAI9C,QAAQ,SAAA,OAAS,SAAQ;;MAElB,IAAG,CAAC,KAAK,YAAY,CAAC,SAAO;QAAE;OAAO,KAChC,SAAS,QAAQ,UAAC,MAAQ;QAAC,KAAK,WAAW;;MAChD,QAAQ,WAAW;MACnB,KAAK,KAAK,UAAU;MACpB,KAAK,KAAK,YAAY,QAAQ,QAAQ,OAAO;MAC7C,KAAK,OAAO,QAAQ,YAAY,KAAK,KAAK;MAC1C,KAAK,OAAO,QAAQ,UAAU,KAAK,KAAK;MACxC,KAAK,OAAO,SAAS;;;IAI3B,UAAW,SAAA,SAAS,QAAO;MACzB,KAAK,KAAK,UAAU,OAAO,QAAQ;MACnC,KAAK;;;;;;kBAGO","file":"v2.steps/select-dataset.js","sourcesContent":["import angular from 'angular';\r\n\r\nvar m = angular.module(\"app.widgets.v2.steps.select-dataset\",[\"ngFileUpload\", \"app.dps\"]);\r\n\r\nm.factory(\"SelectDataset\",[\"$upload\", '$http', '$dps', '$timeout', \"$lookup\", \"$translate\",\r\n\r\n  function($upload, $http, $dps, $timeout, $lookup, $translate){\r\n\treturn {\r\n\r\n    id: \"SelectDataset\",\r\n\t\t\r\n\t\ttitle : \"Dataset\",\r\n\t\t\r\n\t\tdescription : \"Select or upload dataset\",\r\n        \r\n    html : \"./widgets/v2.steps/select-dataset.html\",\r\n\r\n    formatDate: function(date){\r\n      var locale = $translate.use() || \"en\";\r\n      date = new Date(date);\r\n      date = date.toLocaleString(locale,\r\n        { year: 'numeric',  \r\n          month: 'long',  \r\n          day: 'numeric', \r\n          hour: 'numeric',  \r\n          minute: 'numeric',\r\n          second: 'numeric'\r\n        })\r\n      return date;\r\n    },\r\n\r\n    lookup: $lookup,\r\n\r\n\r\n    onStartWizard: function(wizard){\r\n      this.wizard = wizard\r\n      this.conf = {};\r\n      wizard.process(this);\r\n     //  this.wizard = wizard;\r\n      \r\n     //  this.conf = (wizard.conf) ? {\r\n     //      datasetID : wizard.conf.datasetID,\r\n     //      dataset : wizard.conf.dataset \r\n     //    } : {}\r\n      \r\n     //  wizard.context.datasetID = this.conf.datasetID;\r\n     //  wizard.context.dataset = this.conf.dataset;\r\n      \r\n    \t// if( angular.isUndefined(this.conf.dataset)){\r\n     //  \t\twizard.process(this);\r\n     //  \t}else{\r\n     //      wizard.complete(this);\r\n     //    }\r\n      },\r\n\r\n    onFinishWizard: function(wizard){\r\n      // wizard.conf.datasetID = this.conf.datasetID;\r\n      // this.conf = {};\r\n    },\r\n\r\n    updateDatasetList: function(){\r\n    \tvar thos = this;\r\n    \tthis.pending = true;\r\n      $dps.post(\"/api/metadata/items\")\r\n    \t.success(function (data) {\r\n        thos.datasets = data;\r\n        thos.pending = false;  \r\n    \t})\r\n    \t.error(function (data, status) {\r\n      \t\t$window.alert(\"$http error \" + status + \" - cannot load data\");\r\n    \t});\r\n  \t},\r\n\r\n\t\tselect: function(dataset){\r\n          // console.log(\"SELECT\", this.wizard);\r\n        \tif(!this.datasets || !dataset) return;\r\n          this.datasets.forEach((item) =>{item.selected = false});\r\n          dataset.selected = true;\r\n          this.conf.dataset = dataset;\r\n          this.conf.datasetID = dataset.dataset.commit.id;\r\n          this.wizard.context.datasetID = this.conf.datasetID;\r\n          this.wizard.context.dataset = this.conf.dataset;\r\n          this.wizard.complete(this);\r\n      \t},\r\n\r\n\r\n    activate : function(wizard){\r\n      this.conf.dataset = wizard.context.dataset;\r\n      this.updateDatasetList();\r\n    }\t\r\n\t}\r\n}]);\t"],"sourceRoot":"/source/"}