{"version":3,"sources":["v2.steps/stacked-area-chart-decoration.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,kBAAkB,UAAU,KAAK,EAAE,OAAO,OAAO,IAAI,aAAa,IAAI,aAAa;;AAEvF,IAJO,UAAO,gBAAA,QAAM;;AAMpB,QALO;;AAOP,QANO;;AAQP,QAPO;;AASP,QARO;;AAEP,IAAI,IAAI,QAAQ,OAAO,sDAAqD,CAC3E,wBACA,8BACG,6BACA;;AAEJ,EAAE,QAAQ,8BAA6B,CACtC,YAAY,SAAQ,gBAAe,aAAa,sBAChD,UAAS,UAAS,OAAO,cAAc,WAAW,oBAAoB;CACtE,OAAO;;EAEN,OAAQ;;EAER,aAAc;;EAEX,MAAO;;EAEP,UAAW;;EAEX,eAAe,SAAA,cAAS,QAAO;GAC9B,KAAK,SAAS;GACd,IAAG,KAAK,UAAS;IAChB,KAAK,SAAS,UAAU;IACxB,KAAK,SAAS,OAAO;;;;EAIvB,gBAAiB,SAAA,eAAS,QAAO;GAChC,OAAO,KAAK,aAAa,KAAK;;;EAG/B,UAAW,SAAA,SAAS,SAAQ;GAC3B,KAAK,WAAW,QAAQ;GACxB,IAAG,KAAK,WAAW,kBAAkB,MAAM,KAAK;;;EAGpD,gBAAgB,SAAA,iBAAU;GACzB,IAAK,KAAK,WAAW,OAAO;IAC3B,IAAI,MAAM;IACV,KAAI,IAAI,IAAI,KAAK,WAAW,MAAM,SAAO,GAAG,KAAK,GAAG,KAAI;KACvD,IAAI,KAAK,KAAK,WAAW,MAAM;;;IAGhC,KAAK,WAAW,QAAM;IACtB,IAAI,OAAO;IACX,IAAI,QAAQ,UAAS,MAAK;KACzB,KAAK,WAAW,MAAM,KAAK;;;;;EAK9B,aAAa,SAAA,cAAU;GACtB,IAAG,KAAK,cAAa;IACpB,KAAK,UAAU,KAAK;IACpB;;;GAGD,KAAK,UAAU;IACD,SAAW,KAAK;IAChB,QACA;KACE,MAAS,KAAK,oBAAoB;KAClC,WAAc,KAAK,oBAAoB;KACvC,WAAc,KAAK,oBAAoB;KACvC,YAAe,KAAK,oBAAoB;KACxC,mBAAqB,KAAK,oBAAoB;KAC9C,gBAAkB,KAAK,oBAAoB;KAC3C,OAAU,KAAK,oBAAoB;;;IAGrC,WAAa;IACb,eAAiB;;GAEzB,KAAK,eAAe,KAAK;;;EAG9B,cAAc,SAAA,eAAU;GACvB,IAAI,eAAe,KAAK,OAAO,YAAY;GACxC,KAAK,IAAI,KAAK,cAAc;IACd,KAAK,QAAQ,MAAM,KAAK,aAAa;;;GAIzC,IAAG,QAAQ,UAAU,eAAc;IACjC,IAAI,aAAa,MAAM;KACrB,KAAK,QAAQ,MAAM,IAAI,aAAa;;;IAGtC,IAAI,aAAa,MAAM;KACrB,KAAK,QAAQ,MAAM,IAAI,aAAa;;;IAGtC,KAAK,QAAQ,MAAM,QAAQ,aAAa;;IAExC,IAAI,KAAK,QAAQ,MAAM,SAAS;KAC9B,KAAK,QAAQ,MAAM,QAAQ,QAAQ,aAAa;;IAElD,IAAI,KAAK,QAAQ,MAAM,OAAO;KAC5B,KAAK,QAAQ,MAAM,MAAM,QAAQ,aAAa;;IAEhD,IAAI,KAAK,QAAQ,MAAM,WAAW,QAAQ,SAAS,KAAK,QAAQ,MAAM,UAAU;;KAE9E,KAAK,QAAQ,MAAM,QAAQ,QAAQ,aAAa;;;;;EAKpE,UAAW,SAAA,SAAS,QAAO;;GAE1B,KAAK,sBAAsB,OAAO,KAAK;GACvC,KAAK,gBAAgB,OAAO,KAAK;GACjC,KAAK,eAAe,OAAO,KAAK;GAChC,KAAK,aAAa,OAAO,KAAK;;GAE9B,KAAK;GACL,IAAI,OAAO;;GAEX,IAAI,YACG,KAAK,cAAa,UAAS,WAAU;IACpC,MAAM,IAAI,4CACT,QAAQ,UAAS,MAAK;KACpB,KAAK,UAAU;;KAEhB,IAAG,KAAK,YAAW;MAClB,mBAAmB,gBAAgB,KAAK,SAAQ,KAAK;YACjD;MACJ,KAAK,aAAa,mBAAmB,cAAc,KAAK;;KAEzD,KAAK,WAAW,QAAQ,aAAa,KAAK,OAAO,MAAM;KACvD,KAAK;;;;;;KAML,UAAU;;MAGb,KAAK,kBAAiB,UAAS,WAAU;IACvC,MACE,KAAK,uBACJ,KAAK,SAEN,QAAQ,UAAU,MAAM;KACxB,KAAK,OAAO,KAAK;KACd,KAAK,UAAU,KAAK;KACpB,QAAQ,IAAI,KAAK;KACjB,UAAU,QAAQ,KAAK;;MAG9B,QAAQ,KAAK,eAAc,UAAS,MAAK;IACzC,KAAK,cAAc;IACnB,KAAK,OAAO,SAAS;IACrB,KAAK,WAAW,EAAC,SAAQ,QAAQ,KAAK,KAAK,UAAU,MAAK,QAAQ,KAAK,KAAK;;;;EAMpF,OAAO,SAAA,QAAU;;GAEhB,KAAK,WAAW,QAAQ,aAAa,KAAK,OAAO,MAAM;GACvD,mBAAmB,gBAAgB,KAAK,SAAQ,KAAK;GACrD,KAAK,WAAW,EAAC,SAAQ,QAAQ,KAAK,KAAK,UAAU,MAAK,QAAQ,KAAK,KAAK;;;;IAI3E","file":"v2.steps/stacked-area-chart-decoration.js","sourcesContent":["import angular from 'angular';\r\nimport \"widgets/v2.steps/palettes\";\r\nimport 'widgets/v2.nvd3-widget/nvd3-widget';\r\nimport 'widgets/data-util/dps';\r\nimport \"widgets/v2.nvd3-stacked-area/adapter\";\r\n\r\nvar m = angular.module(\"app.widgets.v2.steps.stacked-area-chart-decoration\",[\r\n\t\"app.widgets.palettes\",  \r\n\t'app.widgets.v2.nvd3-widget',\r\n    \"app.widgets.data-util.dps\",\r\n    \"app.widgets.v2.stacked-area-chart-adapter\"]);\r\n\r\nm.factory(\"StackedAreaChartDecoration\",[\r\n\t\"Palettes\", \"$http\",\"parentHolder\",\"Requestor\", \"StackedAreaAdapter\", \r\n\tfunction(Palettes,$http, parentHolder, Requestor, StackedAreaAdapter ){\r\n\treturn {\r\n\t\t\r\n\t\ttitle : \"Chart Decoration\",\r\n\t\t\r\n\t\tdescription : \"Setup chart decoration options\",\r\n        \r\n    \thtml : \"./widgets/v2.steps/stacked-area-chart-decoration.html\",\r\n\r\n    \tpalettes : Palettes,\r\n\r\n    \tonStartWizard: function(wizard){\r\n    \t\tthis.wizard = wizard;\r\n    \t\tif(this.settings){\r\n    \t\t\tthis.settings.options = undefined;\r\n    \t\t\tthis.settings.data = undefined;\r\n    \t\t}\r\n    \t},\r\n\r\n    \tonFinishWizard:  function(wizard){\r\n    \t\twizard.conf.decoration = this.decoration;\r\n    \t},\r\n\r\n    \tsetColor : function(palette){\r\n    \t\tthis.decoration.color = palette;\r\n    \t\tif(this.decoration.reversePalette == true) this.reversePalette();\r\n    \t},\r\n\t\t\r\n\t\treversePalette: function(){\r\n\t\t\tif ( this.decoration.color ){\r\n\t\t\t\tvar tmp = [];\r\n\t\t\t\tfor(var i = this.decoration.color.length-1; i >= 0; i--){\r\n\t\t\t\t\ttmp.push(this.decoration.color[i]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.decoration.color=[];\r\n\t\t\t\tvar thos = this;\r\n\t\t\t\ttmp.forEach(function(item){\r\n\t\t\t\t\tthos.decoration.color.push(item);\r\n\t\t\t\t})\r\n\t\t\t}\t\r\n\t\t},\r\n\r\n\t\tmakeRequest: function(){\r\n\t\t\tif(this.serieRequest){\r\n\t\t\t\tthis.request = this.serieRequest;\r\n\t\t\t\treturn;\t\r\n\t\t\t}\r\n\r\n\t\t\tthis.request = {\r\n\t                \"data_id\": this.queryResultId,\r\n\t                \"params\": \r\n\t                {\r\n\t                  \"mode\" : this.postprocessSettings.mode,\r\n\t                  \"direction\" : this.postprocessSettings.direction,\r\n\t                  \"precision\" : this.postprocessSettings.precision,\r\n\t                  \"normalized\" : this.postprocessSettings.normalize,\r\n\t                  \"useColumnMetadata\": this.postprocessSettings.useColumnMetadata,\r\n\t                  \"useRowMetadata\": this.postprocessSettings.useRowMetadata,\r\n\t                  \"axisX\" : this.postprocessSettings.axisX\r\n\t                  \r\n\t                },\r\n\t                \"proc_name\": \"scatter-serie\",\r\n\t                \"response_type\": \"data\"\r\n\t              };\r\n\t        this.serieRequest = this.request;      \r\n\t   },\r\n\r\n\t   setupOptions: function(){\r\n\t   \tvar serieAdapter = this.wizard.parentScope.serieAdapter;\r\n\t   \t\t  for (var i in serieAdapter) {\r\n                      this.options.chart[i] = serieAdapter[i];\r\n                   }\r\n  \r\n                  \r\n                  if(angular.isDefined(serieAdapter)){\r\n                    if (serieAdapter.getX) {\r\n                      this.options.chart.x = serieAdapter.getX;\r\n                    }\r\n\r\n                    if (serieAdapter.getY) {\r\n                      this.options.chart.y = serieAdapter.getY;\r\n                    }\r\n\r\n                    this.options.chart.label = serieAdapter.getLabel;\r\n\r\n                    if (this.options.chart.scatter) {\r\n                      this.options.chart.scatter.label = serieAdapter.getLabel;\r\n                    }\r\n                    if (this.options.chart.lines) {\r\n                      this.options.chart.lines.label = serieAdapter.getLabel;\r\n                    }\r\n                    if (this.options.chart.stacked && angular.isObject(this.options.chart.stacked)) {\r\n\r\n                      this.options.chart.stacked.label = serieAdapter.getLabel;\r\n                    }\r\n                  }   \r\n\t   },\r\n\r\n\t\tactivate : function(wizard){\r\n\t\t\t\r\n\t\t\tthis.postprocessSettings = wizard.conf.postprocessSettings;\r\n\t\t\tthis.queryResultId = wizard.conf.queryResultId;\r\n\t\t\tthis.serieRequest = wizard.conf.serieRequest;\r\n\t\t\tthis.decoration = wizard.conf.decoration;\r\n\r\n\t\t\tthis.makeRequest();\r\n\t\t\tvar thos = this;\r\n\r\n\t\t\tnew Requestor()\r\n\t        .push(\"getOptions\",function(requestor){\r\n\t          $http.get(\"./widgets/nvd3-stacked-area/options.json\")\r\n\t          .success(function(data){\r\n\t             thos.options = data;\r\n                \r\n\t            if(thos.decoration){\r\n\t            \tStackedAreaAdapter.applyDecoration(thos.options,thos.decoration)\r\n\t            }else{\r\n\t            \tthos.decoration = StackedAreaAdapter.getDecoration(thos.options);\r\n\t            }\r\n\t            thos.decoration.width = parentHolder(thos.wizard.conf).width;\r\n\t            thos.setupOptions();\t\r\n\t          //    thos.options.chart.x = function (d) { return d.label };\r\n           //       thos.options.chart.y = function (d) { return d.value };\r\n           //       thos.options.chart.tooltipContent: function (serie, x, y, s) {\r\n           //    \t\t\treturn \"<center><b>\" + s.point.label + \"</b><br/>\" + s.series.key + \" : \" + s.point.value.toFixed(2) + \"</center>\"\r\n           //  \t};\r\n\t            requestor.resolve();\r\n\t          })                \r\n\t        })\r\n\t        .push(\"generateSeries\",function(requestor){\r\n\t          \t$http\r\n\t            .post(\"./api/data/process/\",\r\n\t              thos.request    \r\n\t            )\r\n\t            .success(function (data) {\r\n\t            \tthos.data = data.data;\r\n\t                thos.data_id = data.data_id;\r\n\t                console.log(thos.data)\r\n\t                requestor.resolve(data.data_id)\r\n\t          \t})\r\n\t         })\r\n\t        .execute(this.queryResultId,function(data){\r\n\t        \tthos.serieDataId = data;\r\n\t        \tthos.wizard.complete(thos);\r\n\t        \tthos.settings = {options:angular.copy(thos.options), data:angular.copy(thos.data)}\r\n\t        \t\r\n\t         });\r\n          \r\n\t\t},\r\n\r\n\t\tapply: function(){\r\n\r\n\t\t\tthis.decoration.width = parentHolder(this.wizard.conf).width;\r\n\t\t\tStackedAreaAdapter.applyDecoration(this.options,this.decoration);\r\n\t\t\tthis.settings = {options:angular.copy(this.options), data:angular.copy(this.data)};\r\n\t\t\t// this.makeRequest();\r\n\t\t}\t\r\n    }\r\n}]);    \t\r\n"],"sourceRoot":"/source/"}