{"version":3,"sources":["v2.nvd3-gantt/gantt-chart-decoration.js"],"names":[],"mappings":"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","file":"v2.nvd3-gantt/gantt-chart-decoration.js","sourcesContent":["import angular from 'angular';\r\nimport 'widgets/v2.nvd3-widget/nvd3-widget';\r\nimport \"widgets/v2.nvd3-gantt/adapter\";\r\nimport \"wizard-directives\";\r\n\r\n\r\nvar m = angular.module(\"app.widgets.v2.steps.gantt-chart-decoration\",[\r\n\t'app.widgets.v2.nvd3-widget',\r\n    \"app.widgets.v2.gantt-chart-adapter\", \r\n    \"wizard-directives\"]);\r\n\r\nm.factory(\"GanttChartDecoration\",[\r\n\t\"$http\",\r\n\t\"$q\", \r\n\t\"dialog\",\r\n\t\"appUrls\",\r\n\t\"parentHolder\",\r\n\t\"GanttChartAdapter\", \r\n\t\"pageWidgets\",\r\n\tfunction(\r\n\t\t$http, \r\n\t\t$q, \r\n\t\tdialog,\r\n\t\tappUrls,\r\n\t\tparentHolder, \r\n\t\tGanttChartAdapter,\r\n\t\tpageWidgets ){\r\n\t\t\r\n\t\tlet chartAdapter = GanttChartAdapter;\r\n\r\n\t\treturn {\r\n\t\t\tid: \"GanttChartChartDecoration\",\r\n\r\n\t\t\ttitle : \"Chart Decoration\",\r\n\t\t\t\r\n\t\t\tdescription : \"Setup chart decoration options\",\r\n\t        \r\n\t    \thtml : \"./widgets/v2.nvd3-gantt/gantt-chart-decoration.html\",\r\n\r\n\t    \tonStartWizard: function(wizard){\r\n\t    \t\tthis.wizard = wizard;\r\n\t    \t\tthis.conf = {\r\n\t    \t\t\tdecoration : wizard.conf.decoration,\r\n\t    \t\t\tdataID : wizard.conf.dataID,\r\n\t    \t\t\tserieDataId: wizard.conf.dataID,\r\n\t    \t\t\toptionsUrl : \"./widgets/v2.nvd3-gantt/options.json\",\r\n\t    \t\t\tdataUrl : \"./api/data/process/\"\r\n\t    \t\t}\t\r\n\t    \t},\r\n\r\n\t    \tonFinishWizard:  function(wizard){\r\n\t    \t\twizard.conf.decoration = this.conf.decoration;\r\n\t    \t\twizard.conf.dataID  = this.conf.dataID;\r\n\t    \t\twizard.conf.serieDataId  = this.conf.serieDataId;\r\n\t    \t\tthis.settings = {options:angular.copy(this.options), data:[]};\r\n\t    \t\tthis.conf = {};\r\n\t    \t},\r\n\r\n\t    \tonCancelWizard: function(wizard){\r\n\t\t\t\tthis.settings = {options:angular.copy(this.options), data:[]};\r\n\t\t\t\tthis.conf = {};\r\n\t    \t},\r\n\r\n\t    \t\r\n\t    \t_prepare : function(data){\r\n              var result = data.map((item) => {return item})\r\n              result.forEach((item) => {\r\n                if(item.end == null) delete item.end;\r\n                if(item.note == null) delete item.note;\r\n                \r\n                if(item.income == null) {\r\n                  delete item.income\r\n                }else{\r\n                  item.income.forEach((p) => {\r\n                    if(p.marker == null) delete p.marker\r\n                  })\r\n                } \r\n\r\n                if(item.expenditure == null) {\r\n                  delete item.expenditure\r\n                }else{\r\n                  item.expenditure.forEach((p) => {\r\n                    if(p.marker == null) delete p.marker\r\n                  })\r\n                } \r\n\r\n                if(item.causes == null) {\r\n                  delete item.causes\r\n                }else{\r\n                  item.causes.forEach((p) => {\r\n                    if(p.type == null) {\r\n                      delete p.type\r\n                      delete p.src.type\r\n                      delete p.target.type\r\n                    }  \r\n                  })\r\n                }  \r\n\r\n              })\r\n              return result;\r\n            },\r\n\t\t\t\r\n\t\t\tcreateTimeline: function(){\r\n\t\t\tvar thos = this;\t\r\n\t\t\t  dialog({\r\n\t\t        title:\"Select Timeline Excel file\",\r\n\t\t        fields:{\r\n\t\t          file:{\r\n\t\t            title:\"Timeline file:\", \r\n\t\t            type:'file', \r\n\t\t            editable:true, \r\n\t\t            required:true\r\n\t\t          }\r\n\t\t        }\r\n\t\t      })\r\n\t\t      \t.then((form) =>{\r\n\r\n\t\t\t        const fd = new FormData();\r\n\t\t\t        // Take the first selected file\r\n\t\t\t        fd.append('file', form.fields.file.value);\r\n\t\t\t        $http\r\n\t\t\t        \t.post(appUrls.createTimeline, fd, {\r\n\t\t\t\t          withCredentials: true,\r\n\t\t\t\t          headers: {'Content-Type': undefined},\r\n\t\t\t\t          transformRequest: angular.identity\r\n\t\t\t\t        })\r\n\t\t\t\t        .success(resp => {\r\n\t\t\t\t          \tthos.data = resp.value;\r\n\t\t\t\t          \tthos.conf.dataID = resp.id;\r\n\t\t\t\t          \tthos.conf.serieDataId = resp.id;\r\n\t\t\t\t          \tthos.loadData();\r\n\t\t\t\t        })\r\n\t\t\t\t        .error((data, status) => {\r\n\t\t\t\t          \tif (status === 415) {\r\n\t\t\t\t            \talert.error($translate.instant('WIDGET.V2.APP-LIST.CANNOT_PARSE_DATA_AS_VALID_JSON', {data}));\r\n\t\t\t\t          \t} else {\r\n\t\t\t\t            \talert.error($translate.instant('WIDGET.V2.APP-LIST.ERROR_IMPORTING_APP', {status}));\r\n\t\t\t\t          \t}\r\n\t\t\t\t        });\r\n\t\t\t\t})        \r\n\t\t    },\r\n\r\n\t\t\t\r\n\t\t\tloadOptions : function(){\r\n\t\t\t\treturn $http.get(this.conf.optionsUrl)\r\n\t\t\t},\r\n\r\n\t\t\tloadSeries : function(){\r\n\t\t\t\treturn $http.get(\"./api/data/process/\"+this.conf.serieDataId)\r\n\t\t\t}, \r\n\r\n\t\t\t\r\n\t\t   loadData: function(){\r\n\t\t\t\tlet thos = this;\r\n\t\t\t\t$q\r\n\t\t\t\t\t.all([\r\n\t\t\t\t\t\tthos.loadOptions().then((resp) =>{\r\n\t\t\t\t\t\t\tthos.options = resp.data;\r\n\t\t\t\t\t\t\tif(!thos.conf.decoration){\r\n\t\t\t            \t\tthos.conf.decoration = chartAdapter.getDecoration(thos.options);\r\n\t\t\t            \t}\r\n\t\t\t            \t// console.log(\"thos.options\",thos.options)\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tthos.loadSeries().then((resp) => {\r\n\t\t\t\t\t\t\t// console.log(\"resp\",resp.data.value)\r\n\t\t\t\t\t\t\tthos.data =thos._prepare( resp.data.value)\r\n\t\t\t\t\t\t\tconsole.log(\"thos.data\",thos.data)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t])\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tthos.apply();\r\n\t\t\t\t\t})\r\n\r\n\t\t\t},\r\n\r\n\t\t\tactivate : function(wizard){\r\n\t\t\t\tif (this.conf.dataID){\r\n\t\t\t\t\tthis.loadData();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tapply: function(){\r\n\t\t\t\tthis.conf.decoration.width = parentHolder(this.wizard.conf).width;\r\n\t\t\t\tchartAdapter.applyDecoration(this.options,this.conf.decoration);\r\n\t\t\t\tthis.settings = {options:angular.copy(this.options), data:angular.copy(this.data)};\r\n\t\t\t\t// console.log(\"this.settings\",this.settings)\r\n\t\t\t\t\r\n\t\t\t}\t\r\n\t    }\r\n}]);    \t\r\n\r\n"],"sourceRoot":"/source/"}