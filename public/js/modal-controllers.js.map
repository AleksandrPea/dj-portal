{"version":3,"sources":["modal-controllers.js"],"names":[],"mappings":"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","file":"modal-controllers.js","sourcesContent":["import angular from 'angular';\r\nimport 'angular-foundation';\r\nimport 'angular-oclazyload';\r\nimport 'sceditor';\r\nimport 'template-cached-pages';\r\nimport 'file-upload';\r\n\r\nconst modals = angular.module('app.modals', ['ngFileUpload']);\r\n\r\nmodals.controller('WidgetModalSettingsController', function ($scope, $modalInstance, $timeout,\r\n                                                          widgetScope, widgetConfig, widgetType,\r\n                                                          app) {\r\n  let data = angular.copy(widgetConfig);\r\n\r\n  // split widgetConfig into basicProperties (not available in json-editor)\r\n  // and data - everything else, modifiable in json-editor\r\n  delete data.instanceName;\r\n  delete data.type;\r\n  delete data.icon;\r\n\r\n  angular.extend($scope, {\r\n    widgetScope,\r\n    widgetType,\r\n    widgetConfig: data,\r\n\r\n    basicProperties: {\r\n      type: widgetConfig.type,\r\n      instanceName: widgetConfig.instanceName,\r\n      icon: widgetConfig.icon\r\n    },\r\n\r\n    ok() {\r\n      // Use $timeout as a fix for android\r\n      // On mobile devices (at least android) `data` is updated AFTER `ng-click` event happens if\r\n      // submit button is pressed while input fields are still focused.\r\n      // this is probably related to touch vs mouse behaviour and underlying json-editor implementation.\r\n      $timeout(() => {\r\n        $modalInstance.close(angular.extend(data, $scope.basicProperties));\r\n        app.markModified(true);\r\n      }, 100);\r\n    },\r\n\r\n    cancel() {\r\n      $modalInstance.dismiss();\r\n    },\r\n\r\n    updateData(value) {\r\n      data = value;\r\n    }\r\n  });\r\n});\r\n\r\nmodals.controller('WidgetModalAddNewController', function ($scope, $modalInstance, $log,\r\n                                                        $timeout, $translate,\r\n                                                        holder, appUrls,\r\n                                                        widgetTypes,user) {\r\n  // create array instead of map (easy filtering)\r\n  var widgetTypesArr = [];\r\n\r\n  for (let type in widgetTypes.data) {\r\n    const currentWidget = {\r\n      type\r\n    };\r\n\r\n\r\n\r\n    const translationId = `WIDGET.${type.toUpperCase()}.DESCRIPTION`;\r\n    $translate(translationId).then(translation => {\r\n      if (translation === translationId) {\r\n        currentWidget.description = $translate.instant('WIDGET_HAS_NO_DESCRIPTION');\r\n      } else {\r\n        currentWidget.description = translation;\r\n      }\r\n    });\r\n\r\n    //add keywords\r\n    \r\n    currentWidget.keywords = (widgetTypes.data[type].keywords) ? widgetTypes.data[type].keywords: [];\r\n\r\n    // add path to icon of a widget\r\n    if (widgetTypes.data[type].noicon) {\r\n      currentWidget.icon = appUrls.defaultWidgetIcon;\r\n    } else {\r\n      currentWidget.icon = appUrls.widgetIcon(currentWidget.type);\r\n    }\r\n    // console.log(\"Grant for \", widgetTypes.data[type])\r\n    currentWidget.grant = (widgetTypes.data[type].grant) ? widgetTypes.data[type].grant : ['owner','collaborator',\"administrator\"]\r\n    widgetTypesArr.push(currentWidget);\r\n  }\r\n\r\n  $scope.tags = [];\r\n  widgetTypesArr.forEach((w) => {\r\n    w.keywords.forEach( (t) => {\r\n      if($scope.tags.indexOf(t) < 0) $scope.tags.push(t)\r\n    });\r\n  });\r\n\r\n  $scope.selectedTags = [];\r\n\r\n  var userRoles = [];\r\n  if(user.isAdmin)userRoles.push(\"administrator\");\r\n  if(user.isOwner)userRoles.push(\"owner\");\r\n  if(user.isCollaborator)userRoles.push(\"collaborator\");\r\n\r\n  var hasGrant = function(roles,grants){\r\n    var r = false;\r\n    roles.forEach((role) => {\r\n      r |= grants.indexOf(role) >= 0;\r\n    })\r\n    return r;\r\n  }\r\n\r\n  widgetTypesArr = widgetTypesArr.filter( (w) => { return hasGrant(userRoles,w.grant) } )\r\n\r\n  \r\n  angular.extend($scope, {\r\n    widgetTypes: widgetTypesArr,\r\n    chooseWidget(widget) {\r\n      $scope.chosenWidget = widget;\r\n      // no error as a widget was chosen\r\n      $scope.widgetErr = {};\r\n    },\r\n\r\n    selectTag(t){\r\n      let index = $scope.tags.indexOf(t);\r\n      $scope.tags.splice(index,1);\r\n      $scope.selectedTags.push(t);\r\n      $scope.selectedObject = \"\";\r\n      $scope.$viewValue = \"\";\r\n    },\r\n\r\n    unselectTag(t){\r\n      let index = $scope.selectedTags.indexOf(t);\r\n      $scope.selectedTags.splice(index,1);\r\n      $scope.tags.push(t);\r\n    },\r\n\r\n    hasTags(w){\r\n      let f = true;\r\n      $scope.selectedTags.forEach(t => f &= w.keywords.indexOf(t) >=0 );\r\n      return f;\r\n    },\r\n\r\n    add(widget) {\r\n      // checks whether chosen template belongs to the current filter criteria\r\n      $scope.chosenWidget = widget;\r\n      \r\n      $modalInstance.close($scope.chosenWidget);\r\n    },\r\n\r\n    isSelected(widget) {\r\n      $scope.chosenWidget === widget\r\n    },\r\n\r\n    cancel() {\r\n      $modalInstance.dismiss();\r\n    }\r\n  });\r\n});\r\n\r\nmodals.controller('AddNewPageModalController', function ($scope, $state, $modalInstance,\r\n                                                      $translate, alert,\r\n                                                      app, templateTypes, appUrls) {\r\n  // TODO: Rewrite this piece of SH*T!\r\n\r\n  // array of all template types\r\n  const templateTypesArr = [];\r\n\r\n  // create templateTypesArr out of templateTypes map\r\n  for (let type in templateTypes.data) {\r\n    const currentTemplate = {\r\n      type,\r\n      description: templateTypes.data[type].description,\r\n      holders: templateTypes.data[type].holders,\r\n      icon: appUrls.templateIcon(type)\r\n    };\r\n\r\n    templateTypesArr.push(currentTemplate);\r\n  }\r\n\r\n  $scope.settings = {\r\n\r\n    href: \"\",\r\n\r\n    // check whether shortTitle is correct (isn't empty for now)\r\n    checkShortTitle() {\r\n      $scope.titleErr = {};\r\n      if (!$scope.settings.shortTitle) {\r\n        $scope.titleErr.message = $translate.instant('FIELD_MUSTNT_BE_EMPTY');\r\n        $scope.titleErr.class = 'red';\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    templateTypes: templateTypesArr,\r\n\r\n    // add button action\r\n    add() {\r\n      if (!$scope.settings.checkShortTitle()) {\r\n        return;\r\n      }\r\n\r\n       //if chosen template isn't in the current filter then show an error\r\n      if (!$scope.settings.chosenTemplate) {\r\n        $scope.chosenTemplate = {};\r\n        $scope.templateErr = {};\r\n        $scope.templateErr.message = $translate.instant('CHOOSE_A_TEMPLATE');\r\n        $scope.templateErr.class = 'red';\r\n        return;\r\n      }\r\n\r\n      const page = {\r\n        shortTitle: $scope.settings.shortTitle,\r\n        href: $scope.settings.href,\r\n        template: $scope.settings.chosenTemplate.type,\r\n        holders: {}\r\n      };\r\n\r\n      for (let holderName of $scope.settings.chosenTemplate.holders) {\r\n        page.holders[holderName] = {\r\n          widgets: []\r\n        };\r\n      }\r\n\r\n      app.addNewPage(page);\r\n\r\n      // redirect to the new page\r\n      $state.go('page', {href: $scope.settings.href}, {reload: true});\r\n      $modalInstance.close();\r\n    },\r\n\r\n    chooseTemplate(template) {\r\n      $scope.settings.chosenTemplate = template;\r\n      // don't show any error message\r\n      $scope.templateErr = {};\r\n    },\r\n\r\n    cancel() {\r\n      $modalInstance.dismiss();\r\n    },\r\n\r\n    isSelected(template) {\r\n      return $scope.settings.chosenTemplate === template;\r\n    }\r\n  };\r\n});\r\n\r\nmodals.controller('PageSettingsModalController', function ($scope, $state, $modalInstance,\r\n                                                           $translate, alert,\r\n                                                           app, page) {\r\n  $scope.settings = {\r\n    href: page.href,\r\n    shortTitle: page.shortTitle\r\n  };\r\n\r\n  angular.extend($scope, {\r\n    // check whether shortTitle is correct (isn't empty for now)\r\n    checkShortTitle() {\r\n      this.titleErr = {};\r\n      if (!this.settings.shortTitle) {\r\n        this.titleErr = true;\r\n        this.titleErr.message = $translate.instant('FIELD_MUSTNT_BE_EMPTY');\r\n        this.titleErr.class = 'red';\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    // add button action\r\n    save() {\r\n      if (!this.checkShortTitle()) {\r\n        return;\r\n      }\r\n\r\n      // if nothing changes - emulate pressing cancel button.\r\n      for (let prop in this.settings) {\r\n        if (this.settings[prop] !== page[prop]) {\r\n          angular.extend(page, $scope.settings);\r\n          $modalInstance.close();\r\n          return;\r\n        }\r\n      }\r\n      this.cancel();\r\n    },\r\n\r\n    cancel() {\r\n      $modalInstance.dismiss();\r\n    }\r\n  });\r\n});\r\n\r\nmodals.controller('ShareSettingsModalController', function ($scope, $modalInstance, $http, author, appUrls, config) {\r\n  angular.extend($scope, {\r\n    author,\r\n    collaborations: angular.copy(config.collaborations) || [], // TODO: change to collaborations\r\n\r\n    getUsers(filterValue) {\r\n      // todo: add support for filterValue\r\n      return $http.get(appUrls.usersList).then(result =>\r\n          /* Hack: filters do not work in angular-foundation's typeahead view for some reason */\r\n          result.data\r\n            .filter(user => !this.userIsCollaborator(user))\r\n            .filter(user =>\r\n            user.name.toLowerCase().includes(filterValue.toLowerCase()) ||\r\n            user.email.toLowerCase().includes(filterValue.toLowerCase())\r\n          )\r\n            .slice(0, 8)\r\n      );\r\n    },\r\n\r\n    addCollaboration() {\r\n      this.collaborations.push({\r\n        user: {\r\n          id: this.selectedUser.id,\r\n          name: this.selectedUser.name,\r\n          email: this.selectedUser.email,\r\n          photo: this.selectedUser.photo\r\n        },\r\n        access: undefined // todo: add support for edit/view access rights\r\n      });\r\n    },\r\n\r\n    deleteCollaboration(userId) {\r\n      this.collaborations.splice(this.collaborations.findIndex(user => user.id === userId), 1);\r\n    },\r\n\r\n    userIsCollaborator(user) {\r\n      const isOwner = user.id === (author || {}).id;\r\n      return isOwner || this.collaborations.find(c => c.user.id === user.id);\r\n    },\r\n\r\n    ok() {\r\n      $modalInstance.close(this.collaborations);\r\n    },\r\n\r\n    cancel() {\r\n      $modalInstance.dismiss();\r\n    }\r\n  });\r\n});\r\n\r\nmodals.controller('AppSettingsModalController', function ($scope, $modalInstance,\r\n                                                          appName, appSkins, config) {\r\n  angular.extend($scope, {\r\n    settings: {\r\n      isPublished: config.isPublished,\r\n      name: config.name,\r\n      skinName: config.skinName,\r\n      keywords: config.keywords.join(\", \"),\r\n      title: config.title,\r\n      description: config.description,\r\n      icon:config.icon,\r\n      dps: config.dps\r\n    },\r\n    skins: appSkins,\r\n\r\n    generateIcon() {\r\n      this.settings.icon = \"/img/default/\"+Math.round(20*Math.random())+\".png\";\r\n    },\r\n\r\n\r\n    ok() {\r\n      this.settings.keywords = this.settings.keywords.split(\",\");\r\n      \r\n      for(let i in this.settings.keywords){\r\n        this.settings.keywords[i] = this.settings.keywords[i].trim();  \r\n      }\r\n\r\n      // this.settings.keywords.forEach((item) => {item = item.trim()})\r\n      $modalInstance.close(this.settings);\r\n    },\r\n\r\n    cancel() {\r\n      $modalInstance.dismiss();\r\n    }\r\n  });\r\n});\r\n\r\nmodals.controller(\"ViewPageConfigController\", function($scope, $modalInstance,\r\n                                                       app,config){\r\n  $scope.config = app.pageConfig();\r\n  $scope.holders = [];\r\n  for(let i in $scope.config.holders) $scope.holders.push(i);\r\n  $scope.keys = function(obj){return Object.keys(obj)}\r\n  $scope.ok = function() {\r\n      $modalInstance.close(this.settings);\r\n    },\r\n\r\n  $scope.cancel = function() {\r\n      $modalInstance.dismiss();\r\n    }\r\n\r\n})\r\n\r\nmodals.controller('ResourceManagerController', function (  $scope, $http, $upload, appName,\r\n                                                            dialog, clipboard, \r\n                                                            $modalInstance, $translate) {\r\n    \r\n  \r\n    $scope.appName = appName;\r\n    $scope.upload_process = true;\r\n        \r\n\r\n    \r\n    $scope.copyToClipboard = function(text){\r\n      clipboard.copyText(text);\r\n    }\r\n\r\n    $scope.load = function(){\r\n      $http.get(\"./api/resource\")\r\n      .success(function(data){\r\n        $scope.upload_process = false;\r\n        $scope.resources = data;\r\n      })\r\n    }\r\n      var formatDate = function(date){\r\n      var locale = $translate.use() || \"en\";\r\n      date = new Date(date);\r\n      date = date.toLocaleString(locale,\r\n        { year: 'numeric',  \r\n          month: 'long',  \r\n          day: 'numeric', \r\n          hour: 'numeric',  \r\n          minute: 'numeric',\r\n          second: 'numeric'\r\n        })\r\n      return date;\r\n    }\r\n\r\n     $scope.formatDate = formatDate;\r\n\r\n     $scope.upload = function (file) {\r\n        $scope.upload_process = true;\r\n        $upload.upload({\r\n          url: './api/resource/update',\r\n          method: 'POST',\r\n          headers: {\r\n            'my-header' : 'my-header-value'\r\n          },\r\n          fields:{app:appName},\r\n          file: file,\r\n        })\r\n        .then(function() {\r\n           $scope.load();\r\n        });\r\n     }\r\n\r\n     $scope.fileSelected = function(f,e){\r\n      var files = f;\r\n      \r\n      $scope.formUpload = false;\r\n      if (files != null) {\r\n          $scope.commits = undefined;\r\n          for (var i = 0; i < files.length; i++) {\r\n            $scope.errorMsg = null;\r\n            (function(file) {\r\n                $scope.upload(file);\r\n            })(files[i]);\r\n          }\r\n      }\r\n    };\r\n\r\n    $scope.deleteResource = function(resource){\r\n      $scope.upload_process = true;\r\n      $http.get(\"./api/resource/delete/\"+resource.path)\r\n        .success(function(){\r\n          $scope.upload_process = false;\r\n          $scope.load();\r\n        })\r\n    }\r\n\r\n    $scope.close= function(){\r\n       $modalInstance.close();\r\n    }\r\n\r\n    $scope.renameResource = function(resource){\r\n      dialog({\r\n          title:\"Enter new resource name\",\r\n          fields:{\r\n            oldName:{title:\"Old name\",value:resource.path},\r\n            newName:{title:\"New name\",value:resource.path,editable:true,required:true}\r\n          } \r\n      }).then(function(form){\r\n        $scope.upload_process = true;\r\n        $http.post(\"./api/resource/rename\",\r\n          { app:$scope.appName,\r\n            oldPath:form.fields.oldName.value,\r\n            newPath:form.fields.newName.value\r\n          })\r\n          .success(function(){\r\n            $scope.load();    \r\n          })\r\n      })\r\n    } \r\n\r\n        $scope.upload_process = true;\r\n        $scope.load();\r\n\r\n  });\r\n\r\n\r\nmodals.controller('TranslationManagerController', function ($scope, i18n, $translate, \r\n                                                            dialog, app, clipboard,\r\n                                                            config, $modalInstance) {\r\n\r\n    $scope.prepareTranslations = function(){\r\n      \r\n      // get key collection\r\n      let keys = [];\r\n      for(let locale in config.i18n){\r\n        for (let key in config.i18n[locale]){\r\n          if(keys.filter((item) =>{return item == key}).length == 0){\r\n            keys.push(key)\r\n          }\r\n        }\r\n      }\r\n      //organize table\r\n      $scope.translations = [];\r\n      for(let i in keys){\r\n        let tr = {\"key\":keys[i]}\r\n        for(let locale in config.i18n){\r\n          tr[locale] = config.i18n[locale][keys[i]]\r\n        }\r\n        $scope.translations.push(tr);\r\n      }\r\n    }\r\n\r\n    $scope.prepareTranslations();\r\n\r\n    $scope.close= function(){\r\n       $modalInstance.close();\r\n    }\r\n    \r\n    $scope.copyToClipboard = function(text){\r\n      clipboard.copyText(text);\r\n    }\r\n\r\n    $scope.deleteTranslation = function(t){\r\n      i18n.remove([t.key]);\r\n      $scope.prepareTranslations();\r\n      app.markModified(true);\r\n    }\r\n\r\n    $scope.createTranslation = function(){\r\n      dialog({\r\n        title:\"Create translation\",\r\n        fields:{\r\n          key:{title:\"Key\",editable:true,required:true},\r\n          en:{title:\"English\",editable:true},\r\n          ua:{title:\"Ukrainian\",editable:true},\r\n          ru:{title:\"Russian\",editable:true}\r\n        }\r\n      }).then(function(form){\r\n        app.markModified(true);\r\n        let t = {};\r\n        t[form.fields.key.value] = form.fields.ua.value;\r\n        i18n.add(\"uk\",t);\r\n        t[form.fields.key.value] = form.fields.en.value;\r\n        i18n.add(\"en\",t);\r\n        t[form.fields.key.value] = form.fields.ru.value;\r\n        i18n.add(\"ru\",t);\r\n        $scope.prepareTranslations();\r\n      })\r\n    }\r\n\r\n    $scope.editTranslation = function(translation){\r\n     dialog({\r\n        title:\"Edit translation\",\r\n        fields:{\r\n          key:{title:\"Key\",editable:true,required:true, value:translation.key},\r\n          en:{title:\"English\",editable:true,value:translation.en},\r\n          uk:{title:\"Ukrainian\",editable:true,value:translation.uk},\r\n          ru:{title:\"Russian\",editable:true,value:translation.ru}\r\n        }\r\n      }).then(function(form){\r\n        app.markModified(true);\r\n        if(translation.key != form.fields.key.value){\r\n          $scope.deleteTranslation(translation)\r\n        }\r\n        let t = {};\r\n        t[form.fields.key.value] = form.fields.uk.value;\r\n        i18n.add(\"uk\",t);\r\n        t[form.fields.key.value] = form.fields.en.value;\r\n        i18n.add(\"en\",t);\r\n        t[form.fields.key.value] = form.fields.ru.value;\r\n        i18n.add(\"ru\",t);\r\n        $scope.prepareTranslations();\r\n      }) \r\n    }\r\n    \r\n  });\r\n\r\n\r\n\r\nmodals.factory('addNewPageInModal', function (app, $modal) {\r\n  return () => {\r\n    $modal.open({\r\n      templateUrl: '/widgets/page-list/new-page-modal-config.html',\r\n      controller: 'AddNewPageModalController',\r\n      backdrop: 'static',\r\n      resolve: {\r\n        templateTypes(templateTypesPromise) {\r\n          return templateTypesPromise;\r\n        }\r\n      }\r\n    }).result.then(() => app.markModified(true));\r\n  }\r\n})\r\n\r\nmodals.factory('openPageConfig', function (app, $modal) {\r\n  return page => {\r\n    const thisPage = app.pageConfig().href === page.href;\r\n    $modal.open({\r\n      templateUrl: '/widgets/page-list/page-modal-config.html',\r\n      controller: 'PageSettingsModalController',\r\n      backdrop: 'static',\r\n      resolve: {\r\n        page: () => page\r\n      }\r\n    }).result\r\n      .then(() => {\r\n        app.markModified(true);\r\n        if (thisPage) {\r\n          $state.go('page', {href: page.href}, {reload: true});\r\n        }\r\n      });\r\n}});\r\n\r\n\r\nmodals.controller('PageManagerController', function (\r\n    $scope, \r\n    $translate, \r\n    $modal, \r\n    $modalInstance,\r\n    $state,\r\n    clipboard,\r\n    app, \r\n    appName, \r\n    config,\r\n    globalConfig, \r\n    confirm,\r\n    addNewPageInModal, \r\n    openPageConfig){\r\n  // TODO: synchronize css styles on active link after clicking\r\n  \r\n  angular.extend($scope, {\r\n    appName,\r\n    config,\r\n    addNewPageInModal,\r\n    openPageConfig,\r\n    copyToClipboard(ref){\r\n        clipboard.copyText(\"/app/\"+appName+\"/\"+ ref);\r\n    },\r\n    gotoPage(page){\r\n      $state.go('page', {href: page.href}, {reload: true});\r\n      $modalInstance.close();\r\n    },\r\n    close(){\r\n        $modalInstance.close();\r\n    },\r\n    clonePage(){\r\n      app.clonePage();\r\n    },\r\n    copyPage(){\r\n      app.copyPage();\r\n    },\r\n    pastePage(){\r\n      app.pastePage();\r\n    },\r\n    deletePageWithConfirmation(page) {\r\n      $translate('WIDGET.PAGE-LIST.ARE_YOU_SURE_DELETE_PAGE')\r\n        .then(confirm)\r\n        .then((/*ok*/) => app.deletePage(page))\r\n    }\r\n  });\r\n});\r\n\r\n"],"sourceRoot":"/source/"}